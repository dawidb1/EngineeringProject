\newcommand\size{0.8}
\renewcommand{\arraystretch}{1.5}

\chapter{Wstêp}

Choroba Gravesa jest najczêstsz¹, idiopatyczn¹ form¹ nadczynnoœci tarczycy. To choroba autoimmunologiczna, powodowana nadaktywnoœci¹ przeciwcia³ przeciwtarczycowych (TRAb). Imituj¹ one dzia³anie hormonu TSH, stymuluj¹c receptory TSH (TSHR). Efektem jest nadprodukcja hormonów tarczycy: trójjodotyroniny (T3) i tyroksyny (T4) \cite{wiki}. W konsekwencji prowadzi to do nadczynnoœci tarczycy. Przyczyna choroby nie jest znana.

Standardowe leczenie obejmuje terapiê lekami przeciwtarczycowymi \textit{(antithyroid drugs - ATD)}. Jednym z nich jest metimazol, który hamuje dzia³anie enzymu, odpowiadaj¹cego za syntezê hormonów tarczycy. Taka terapia skutkuje obni¿eniem hormonów T3 i T4, jednak bardzo czêsto wystêpuj¹ reemisje. 

\section{Cel pracy}

Celem pracy jest wsparcie lekarzy w leczeniu choroby autoimmunologicznej Gravesa. Zmniejszenie iloœci stosowanego leku przeciwtarczycowego lub terapia obni¿aj¹ca ryzyko reemisji, zmniejszaj¹ ryzyko wyst¹pienia skutków ubocznych lub ich si³ê. Wymaga to realizacji nastêpuj¹cych etapów:
\begin{itemize}
\item zaznajomienie siê z natur¹ problemu i potrzebami,
\item zastosowanie modelu matematycznego odzwierciedlaj¹cego w³aœciwe funkcje uk³adu hormonalnego,
\item opieranie siê na dostêpnych danych lub mo¿liwych do wykonania badaniach
\item zaadoptowanie modelu do pacjenta, bez potrzeby obserwacji postêpów terapii,
\item stworzenie prostego programu, u³atwiaj¹cego dobór terapii,
\item test programu, poprzez dobór terapii dla prawdziwych danych pacjentów.
\end{itemize}

\section{Uk³ad pracy}

NIEDOKOÑCZONE

\textit{Czasem rozdzia³ koñczy siê omówieniem zawartoœci pracy, t³umacz¹cym co czytelnik znajdzie w kolejnych jej rozdzia³ach.
Ka¿dy rozdzia³ warto jest równie¿ poprzedziæ krótkim wstêpem.}

\chapter{Wprowadzenie teoretyczne}

%\textit{\begin{itemize}
% \item Jak dzia³a tarczyca i jej uk³ad hormonalny. \textit{rysunek poprawnego dzia³ania pêtli sprzê¿enia zwrotnego uk³adu hormonalnego tarczycy}
% \item Co to jest choroba Gravesa. \textit{Tutaj rysunek, jak TRAb emituje dzia³anie TSH.}
% \item Jakie s¹ jej objawy. \textit{Te 3 podpunkty razem.}
% \item U kogo wystêpuje.
% \item Jakie jest na ni¹ lekarstwo. Dzia³anie, skutki uboczne.
%\end{itemize}}



\section{Funkcjonowanie uk³adu hormonalnego tarczycy}
Dzia³anie gospodarki hormonalnej tarczycy opisywane jest za pomoc¹ pêtli sprzê¿enia zwrotnego \cite{mayo}. Stê¿enie hormonów tarczycowych jest sterowane przez centralny uk³ad nerwowy. 

Podwzgórze produkuje tyreoliberynê (TRH), która uwalnia wyprodukowan¹ i zmagazynowan¹ w przysadce mózgowej tyreotropinê (TSH). Jest ona wydzielana do gruczo³ów dokrewnych, w tym do gruczo³u tarczycy, w którym powoduje wytwarzanie hormonów tarczycowych trójjodotyroniny (T3) i tyroksyny (T4). Wysoki poziom T3 i T4 hamuje wytwarzanie TSH, wykazuj¹c ujemne sprzê¿enie zwrotne (Rys.~\ref{feedback-loop_img}).

\begin{figure}
	\centering
	\includegraphics[width=0.5\textwidth]{visio/feedback-loop}
	\caption{Pêtla sprzê¿enia zwrotnego, poprawnie dzia³aj¹cej gospodarki hormonalnej tarczycy \cite{graves1}.}\label{feedback-loop_img}
\end{figure}

W chorobie Gravesa, przeciwcia³a przeciwtarczycowe TRAb imituj¹ dzia³anie hormonu TSH, pochodz¹cego z przysadki mózgowej, aktywuj¹c produkcjê hormonów tarczycowych \cite{graves1}. W efekcie powstaje nadprodukcja hormonów tarczycowych T3 i T4, przy jednoczeœnie niskim poziomie TSH. 

\section{Symptomy}
Hormony tarczycowe maj¹ wp³yw na wiele uk³adów w ca³ym organizmie, dlatego objawy i symptomy wywo³ane chorob¹ Gravesa mog¹ mieæ szeroki zakres oraz znacz¹cy wp³yw na funkcjonowanie ca³ego organizmu. Najczêstsze objawy to \cite{mayo}:
\begin{itemize}
\item niepokój i nerwowoœæ,
\item drobne dr¿enie r¹k i palców,
\item zwiêkszona wra¿liwoœæ na ciep³o, potliwoœæ,
\item utrata wagi, pomimo normalnych nawyków ¿ywieniowych,
\item powiêkszenie siê gruczo³ów tarczycowych,
\item zmiany w cyklach miesi¹czkowych,
\item zaburzenia erekcji lub libido,
\item czêste wypró¿nienia,
\item wy³upiaste oczy,
\item zmêczenie,
\item cienka, czerwona skóra na ³ydkach lub wierzcho³kach stóp,
\item szybkie lub nieregularne bicie serca.
\end{itemize}

\section{Czynniki ryzyka}
Choroba Gravesa mo¿e wyst¹piæ u ka¿dego cz³owieka, jednak niektóre czynniki zwiêkszaj¹ prawdopodobieñstwo jej wyst¹pienia \cite{mayo}:
\begin{itemize}
\item choroba mo¿e byæ uwarunkowana genetycznie, poniewa¿ czêsto jest dziedziczona;
\item czêœciej wystêpuje u kobiet, ni¿ u mê¿czyzn;
\item pojawia siê najczêœciej przed 40 rokiem ¿ycia;
\item wystêpuje z innymi zaburzeniami uk³adu immunologicznego, takimi jak cukrzyca pierwszego stopnia czy reumatoidalne zapalenie stawów;
\item u osób nara¿onych na emocjonalny lub fizyczny stres;
\item ci¹¿a lub niedawny poród mo¿e zwiêkszyæ prawdopodobieñstwo wyst¹pienia zaburzenia;
\item palenie papierosów, które mo¿e wp³ywaæ na uk³ad autoimmunologiczny.

\section{Diagnoza choroby}
Istnieje kilka mo¿liwoœci diagnozowania nadczynnoœci tarczycy oraz jej specyficznej odmiany, jak¹ jest choroba Gravesa. S¹ to:
\item \textit{Test fizyczny.} Lekarz sprawdza, czy oczy s¹ podra¿nione i wystaj¹ce, a gruczo³ tarczycowy jest powiêkszony. Choroba Gravesa zwiêksza metabolizm, dlatego lekarz bada puls i ciœnienie krwi.
\item \textit{Badanie krwi.} Badanie maj¹ce na celu ustalenie poziomu TSH w krwi oraz hormonów tarczycowych. Normalny poziom TSH koreluj¹cy z wysokim poziomem T4 w formie wolnej (FT4), mo¿e œwiadczyæ o nadczynnoœci tarczycy. Dodatkowe badanie iloœci przeciwcia³ przeciwtarczycowych TRAb, pozwala zdiagnozowaæ chorobê Gravesa. Wysoki poziom TRAb i FT4 œwiadcz¹ o pod³o¿u autoimmunologicznym choroby, czyli chorobie Gravesa \cite{graves1}. 
\item \textit{Badanie przyswajalnoœci radioaktywnego jodu.} Organizm potrzebuje jodu, do produkcji hormonów tarczycowych. Podanie ma³ej dawki radioaktywnego jodu oraz póŸniejszy pomiar iloœci hormonów tarczycowych, pozwala ustaliæ przyswajalnoœæ jodu przez tarczycê. Dostarcza to informacji czy nadczynnoœæ tarczycy jest wywo³ana chorob¹ Gravesa. 
\item \textit{Badanie USG.} Dziêki ultradŸwiêkom, mo¿emy ustaliæ czy gruczo³ tarczycowy jest powiêkszony. Jest to bezpieczne badanie, które mo¿e byæ stosowane podczas ci¹¿y.
\end{itemize}

\section{Leczenie}
Leczenie choroby Gravesa, ma na celu zahamowanie produkcji hormonów tarczycowych oraz zmniejszenie ich negatywnego wp³ywu na organizm. Stosowane s¹ \cite{mayo}:
\begin{itemize}
\item terapia  radioaktywnym jodem,
\item leki przeciwtarczycowe (na przyk³ad metimazol),
\item leki beta-adrenolityczne (beta-blockery),
\item operacja chirurgiczna, 
\item leczenie objawu choroby Gravesa – oftalmopatii.
\end{itemize}

Jedn¹ z mo¿liwoœci terapii jest leczenie lekami przeciwtarczycowymi, takimi jak metimazol (Rys.~\ref{trab-mmi_img}). Zmniejsza on produkcjê hormonów tarczycowych poprzez zahamowanie enzymu peroksydazy tarczycowej (TPO), która bierze udzia³ w syntezie hormonów tarczycowych poprzez utlenienie anionów jodu $(I^{-})$. W skutek tego stê¿enie hormonów tarczycowych powraca do poziomu osoby zdrowej. 

\begin{figure}
	\centering
	\includegraphics[width=0.6\textwidth]{visio/trab-mmi}
	\caption{Zahamowanie nadmiernej produkcji hormonów tarczycowych, spowodowanych odpowiedzi¹ autoimmunologiczn¹, poprzez podanie leku przeciwtarczycowego \cite{graves1}.}\label{trab-mmi_img}
\end{figure}

Dotychczas stosowane terapie lekami przeciwtarczycowymi, s¹ uniwersalne, pozbawione indywidualnego podejœcia. W pracy przedstawiono program do symulacji terapii. Na podstawie danych, pozyskanych z badañ pacjenta, pozwala przewidzieæ odpowiedŸ jego organizmu. Pozwala to skuteczniej zaplanowaæ terapiê i przewidzieæ reemisje. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Metodologia}\label{Chapter_Metodologia}

Dobór odpowiedniej dawki leku jest mo¿liwy, poprzez symulacjê zachowania siê organizmu pacjenta oraz jego odpowiedzi na terapiê. Celem terapii jest osi¹gniecie stanu, w którym iloœæ hormonu T4 w formie wolnej (oznaczana jako FT4 \cite{FT4}), zmieni siê do wartoœci charakterystycznej dla osoby zdrowej. 

W napisanej przez Autora niniejszej pracy aplikacji okienkowej, zaimplementowano model matematyczny, przedstawiony w pracy Balamurugan Pandiyan i Stephen J. Merrill \cite{graves1}. Wszelkie za³o¿enia i dane, zaczerpniêto z ich pracy.

\section{Za³o¿enia modelu}
Zaimplementowany model matematyczny pozwala obserwowaæ poziom hormonu T3 w formie wolnej, przeciwcia³ TRAb, metimazolu we krwi pacjenta oraz rozmiar gruczo³u tarczycy w czasie. Poni¿ej zosta³y wyszczególnione za³o¿enia modelu.

\begin{enumerate}
\item Przeciwcia³a tarczycowe TRAb imituj¹ dzia³anie TSH i stymuluj¹ komórki tarczycowe do wzrostu, produkcji i wydzielania hormonów tarczycy.
\item Po za¿yciu doustnie leku w postaci metimazolu (MMI), jest on szybko i~kompletnie absorbowany do surowicy krwi. Jego przyswajalnoœæ, jest estymowana i~wynosi œrednio 93\%.
\item Tarczyca przyswaja MMI z krwi, który dezaktywuje funkcjonalny wzrost gruczo³u. 
\item Dawka leku wch³ania siê z krwi po jego spo¿yciu.
\item Rozmiar gruczo³u tarczycy jest ukrytym kompartmentem w modelu.
\item Po doustnym podaniu leku, stê¿enie metimazolu w surowicy krwi wykazuje tak¹ sam¹ dynamikê, jak stê¿enie wewn¹trz tarczycy.
\end{enumerate}

\section{Funkcje stanu}

%klucze: (warunki pocz¹tkowe, parametry, zmienne stanu??)

Rozwa¿any model jest uk³adem równañ ró¿niczkowych zwyczajnych w którym przyjmujemy nastêpuj¹ce oznaczenia:

\begin{itemize}
\item x(t) - iloœæ metimazolu (mg) na litr surowicy krwi w chwili czasowej t,
\item y(t) - iloœæ hormonu FT4 (pg) na mililitr surowicy krwi w chwili czasowej t,
\item z(t) - rozmiar funkcjonalny gruczo³u tarczycy (ml) lub objêtoœæ aktywnych komórek w chwili czasowej t.
\item w(t) - iloœæ przeciwcia³ TRAb (U) na mililitr krwii w chwili czasowej t,
\item s(t) - poziom MMI przyjêtego doustnie na litr objêtoœci cia³a w chwili czasowej t.

\end{itemize}

\section{Model matematyczny}

Model symuluj¹cy leczenie pacjenta po przyjêciu metimazolu (MMI) \ref{eq:uklad}. 

\begin{equation} \label{eq:uklad}
\left\lbrace 
\arraycolsep=1.5pt\def\arraystretch{2.2}
\begin{array}{ll}

\dfrac{dx}{dt} = s(t) - \dfrac{(k_{1}z)x}{k_{a} + x} - k_{2}x\\

\dfrac{dy}{dt} = \dfrac{(k_{3}z)w}{k_{d} + w } - k_{4}y\\

\dfrac{dz}{dt} = k_{5} (\dfrac{w}{z} - N) - k_{6}zx\\

\dfrac{dw}{dt} = k_{7} - \dfrac{k_{7}x}{k_{b} + x} - k_{8}w\\
\end{array}
\right.
\end{equation}

Rozwi¹zania modelu przyjmuj¹ wartoœci nieujemne $x(t) \geq 0, y(t) \geq 0, z(t) > 0, w(t) \geq 0$ dla dowolnej chwili czasowej t, z warunkami pocz¹tkowymi $E_{0} = (x_{0}, y_{0}, z_{0}, w_{0})$. Szczegó³owy opis uk³adu znajduje siê w dalszej czêœci sekcji.

\begin{equation}
\label{eq:dxdt}
\dfrac{dx}{dt} = s(t) - \dfrac{(k_{1}z)x}{k_{a} + x} - k_{2}x\\
\end{equation}

Równanie \ref{eq:dxdt} opisuje tempo zmian iloœci metimazolu w chwili t, które zale¿y od dawki metimazolu $s(t)$ przyjêtej przez pacjenta w chwili t, pomniejszonej o dwa sk³adniki. Pierwszy sk³adnik $\dfrac{(k_{1}z)x}{k_{a} + x}$, zgodnie z równaniem Michaelisa-Mentena charakteryzuje tempo wch³aniania metimazolu (MMI) przez gruczo³ tarczycy, z uwzglêdnieniem jego rozmiaru ($z$), zak³adaj¹c maksymalny wychwyt leku ($k_{1}$). Drugi sk³adnik $k_{2}x$ odzwierciedla wydalanie lub eliminacjê leku, przez mechanizm niespecyficzny.  /todo wyjaœniæ mechanizm niespecyficzny/

\begin{equation}
\label{eq:dydt}
\dfrac{dy}{dt} = \dfrac{(k_{3}z)w}{k_{d} + w } - k_{4}y \\
\end{equation}

Równanie  \ref{eq:dydt} opisuje tempo zmian hormonu tyroksyny w formie wolnej (FT4) w chwili czasowej t. Pierwsze wyra¿enie $\dfrac{(k_{3}z)w}{k_{d} + w}$, opisuje znany z poprzedniego równania (\ref{eq:dxdt}) mechanizm Michaelisa-Mentena, wykorzystany do obliczenia wskaŸnika wydzielania hormonu FT4. Jest on pomniejszony, o $k_{4}y$ wskaŸnik eliminacji FT4 z krwi. 

\begin{equation}
\label{eq:dzdt}
\dfrac{dz}{dt} = k_{5} (\dfrac{w}{z} - N) - k_{6}zx \\
\end{equation}

Równanie \ref{eq:dzdt} opisuje zmiany funkcjonalnego rozmiaru gruczo³u tarczycy. Pierwszy sk³adnik $k_{5}(\dfrac{w}{z} - N)$ zawiera wspó³czynnik wzrostu ($N$) i wzglêdny wspó³czynnik wzrostu ($k_{5}$), w obecnoœci przeciwcia³ przeciwtarczycowych ($w$) \cite{trab}. Drugi sk³adnik $k_{6}zx$ hamuje tempo zmian poprzez wspó³czynnik funckjonalnego rozmiaru tarczycy dla komórek nieaktywowanych przez leczenie MMI. 

\begin{equation}
\label{eq:dwdt}
\dfrac{dw}{dt} = k_{7} - \dfrac{k_{7}x}{k_{b} + x} - k_{8}w
\end{equation}

Równanie \ref{eq:dwdt} opisuje tempo zmian stê¿enia przeciwcia³ przeciwtarczycowych. Parametr $k_{7}$ przedstawia maksymaln¹ produkcjê przeciwcia³ TRAb, spowodowan¹ odpowiedzi¹ autoimmunologiczn¹, zaœ wyra¿enie $\dfrac{k_{7}x}{k_{b} + x}$, uwzglêdnia mechanizm hamowania odpowiedzi immunologicznej, spowodowany podaniem metimazolu. Ostatnie wyra¿enie $k_{8}w$, odnosi siê do eliminacji TRAb spowodowanego leczeniem.
\\

\section{Parametry modelu} \label{sec:params}
Na podstawie literatury \cite{graves1} przyjêto wartoœci parametrów modelu, zebrane w tabeli (Tab. \ref{tab:params}).

\begin{table}[h]
\caption{Parametry wejœciowe uk³adu równañ ró¿niczkowych.}
\label{tab:params}
\begin{tabular}{|l|l|l|l|}
\hline
\textbf{Parametr} & \textbf{Opis}                                                                                                    & \textbf{Wartoœæ}              & \textbf{Jednostka}            \\ \hline
$k_{1}$                & \begin{tabular}[c]{@{}l@{}}Wzglêdne maksimum wykorzystania \\ MMI.\end{tabular}                                  & $8,374\cdot 10^{3}$ & mg/($ml\cdot l\text{dzieñ}$)                  \\ \hline
$k_{2}$              & WskaŸnik eliminacji MMI.                                                                                         & 3,3271                        & 1/\text{dzieñ}                         \\ \hline
$k_{a}$                & \begin{tabular}[c]{@{}l@{}}Sta³a Michealisa-Mentena po³owicznego \\ maksymalnego wykorzystania MMI.\end{tabular} & 0,358068                      & mg/L                          \\ \hline
$k_{3}$                & Wzglêdne maksimum sekrecji FT4.                                                                                  & Indywidualne                         & $pg/(ml^{2}\cdot\text{dzieñ})$                   \\ \hline
$k_{d}$                & \begin{tabular}[c]{@{}l@{}}Sta³a Michealisa-Mentena\\ po³owicznej maksymalnej  sekrecji FT4.\end{tabular}        & Indywidualne                          & U/ml                          \\ \hline
$k_{4}$                & WskaŸnik eliminacji FT4.                                                                                         & 0,099021                      & 1/\text{dzieñ}                         \\ \hline
$k_{5}$                
& \begin{tabular}[c]{@{}l@{}}
Wzglêdny wspó³czynnik wzrostu \\ gruczo³u tarczycy.\end{tabular}                      & Indywidualne       & $ml^{3}/(U\cdot\text{dzieñ})$ \\ \hline
N                 
& \begin{tabular}[c]{@{}l@{}}
Maksymalny wspó³czynnik wzrostu \\ gruczo³u tarczycy.\end{tabular}                             & Indywidualne                         & $U/(ml^{2})$     \\ \hline
$k_{6}$                
& \begin{tabular}[c]{@{}l@{}}
Wspó³czynnik nieaktywnych komórek \\ tarczycy.\end{tabular}                           & 0,001                         & $ml/(mg\cdot\text{dzieñ})$                   \\ \hline
$k_{7}$                & \begin{tabular}[c]{@{}l@{}}Maksymalny wspó³czynnik produkcji\\ przeciwcia³ TRAb.\end{tabular}                    & Indywidualne & $U/(ml\cdot\text{dzieñ})$                    \\ \hline
$k_{b}$                & \begin{tabular}[c]{@{}l@{}}Wspó³czynnik hamowania produkcji \\ przeciwcia³.\end{tabular}                         & Indywidualne                           & mg/L                          \\ \hline
$k_{8}$                & WskaŸnik eliminacji TRAb.                                                                                        & 0,035                         & 1/\text{dzieñ}                         \\ \hline
\end{tabular}
\end{table}

Maksymalna szybkoœæ przyswajania MMI wzrasta wraz ze zwiêkszaniem dawki leku, przy czym powy¿ej 15 mg/dzieñ, wzrost ten mo¿na pomin¹æ, zatem mo¿na przyj¹æ, i¿ maksymalne wch³anianie leku nastêpuje dla dawki 15 mg/dzieñ. Zak³adaj¹c, ¿e standardowa objêtoœæ funkcjonalna gruczo³u tarczycy podczas nadczynnoœci wynosi 30 ml, a standardowa objêtoœæ organizmu  to 59,71 l, estymujemy parametr $k_{1} = \dfrac{15}{30\cdot 59,71} = 8,374 \cdot 10^{-3} mg/ml\cdot \text{\textit{ldzieñ}}$.

Zak³adaj¹c, ¿e mechanizm wydalania MMI jest wyk³adniczy (malej¹c¹ funkcj¹ wyk³adnicz¹) wyznaczamy parametr $k_2$ z zale¿noœci $k_{2} = \dfrac{ln(2)}{5h} = 3,43711/\text{\textit{dzieñ}}$.

Metimazol jest metabolizowany w w¹trobie \cite{tapazole-liver}, która maksimum wydajnoœci osi¹ga w trakcie aktywnoœci cz³owieka, kiedy jest najedzony \cite{liver}. Najwiêksze wydalanie metimazolu, wystêpuje oko³o godziny 12 dla maksymalnej przyjêtej dawki 15 mg/dzieñ \cite{graves1}. Ta informacja pozwala okreœliæ wartoœæ $k_{a} = 0.358068\: mg/l$ przez symulacje, korzystaj¹c z równania dynamicznego Michealisa-Mentena. 

Parametr $k_{3}$ jest przekszta³conym równaniem \ref{eq:dydt} modelu. Posiadaj¹c informacje z badañ pacjentów podczas ich pierwszej wizyty, mo¿emy obliczyæ
$k_{3} = \dfrac{k_{4}y_{0}(k_{d}+w_{0})}{z_{0}w_{0}}$.

Parametr $k_{d}$ zosta³ estymowany w programie Matlab, u¿ywaj¹c procedury optymalizacyjnej \textbf{fmincon} z doln¹ granic¹ wynosz¹c¹ 0.05 i górn¹ granic¹ 0.1. 

Parametr $k_{4}$ to wspó³czynnik wydalania FT4 z organizmu. Zak³adaj¹c niespecyficzny mechanizm, wspó³czynnik wydalania jest wyk³adniczy (malej¹c¹ funkcj¹ wyk³adnicz¹) i mo¿e byæ wyliczony jako $k_{4} = \dfrac{ln(2)}{7 dni} = 0.099021 \text{\textit{ l/dzieñ}}$.

Nastêpnie $k_{3} = \dfrac{k_{4}y_{0}(k_{d}+w_{0})}{z_{0}w_{0}}$.

Parametry $k_{5}$ oraz $k_{6}$ zosta³y wyznaczone w drodze symulacji.

Parametr N, zosta³ wyliczony bazuj¹c na danych TRAb i FT4 pacjenta $N = \dfrac{w_{0}}{z_{0}}$.

Parametr $k_{8}$ okreœla czas ¿ycia przeciwcia³. Zak³ada siê, ¿e jest on wyk³adniczy (malej¹c¹ funkcj¹ wyk³adnicz¹) i mo¿e zostaæ wyliczony jako $k8 = \dfrac{ln(2)}{20dni} = 0.035 \text{\textit{ l/dzieñ}}$. 

Parametr $k_{7}$ zosta³ estymowany jako 
$k_{7} = k_{8} \cdot w_{0}$.

Parametr $k_{b}$ jest wspó³czynnikiem po³owicznego maksymalnego hamowania stê¿enia przeciwcia³ TRAb (sta³a Michealisa-Mentena), który estymujemy, za pomoc¹ procedury \textbf{fmincon} w doln¹ granic¹ 3 i górn¹ 12.

%\begin{equation} 
%\end{equation}
%
%\begin{equation} \label{eq2}
%\dfrac{dy}{dt} = \dfrac{(k_{3}z)w}{k_{d} + w } - k_{4}y, \quad y(t0) = y0
%\end{equation}
%
%\begin{equation} \label{eq3}
%\dfrac{dz}{dt} = k_{5} (\dfrac{w}{z} - N) - k_{6}zx, \quad z(t0) = z0
%\end{equation}
%
%\begin{equation} \label{eq4}
%\dfrac{dw}{dt} = k_{7} - \dfrac{k_{7}x}{k_{b} + x} - k_{8}w, \quad w(t0) = w0 
%\end{equation}

\section{Warunki pocz¹tkowe modelu}

Warunki pocz¹tkowe modelu $E_{0} = (x_{0}, y_{0}, z_{0}, w_{0})$, zosta³y ustalone w sposób nastêpuj¹cy:

Stê¿enie pocz¹tkowe FT4 $(y_{0})$ oraz przeciwcia³ TRAb $(w_{0})$ pochodzi z badañ podczas pierwszej wizyty pacjenta. 

Pocz¹tkowe stê¿enie MMI $(x_{0})$ w surowicy krwi wyliczono zgodnie ze wzorem \ref{eq:x0} na podstawie przyjêtej dawki leku w stosunku do jego dystrybucji w objêtoœci surowicy krwi równej 3 litry. 

\begin{equation}
\label{eq:x0}
x_{0} = \dfrac{\text{Dawka leku}}{\text{Objêtoœæ dystrybucji leku w surowicy krwi}}
\end{equation}


Pocz¹tkowy rozmiar funkcjonalny tarczycy $(z_{0})$ mo¿na wyznaczyæ przyjmuj¹c za³o¿enie, ¿e w chwili pocz¹tkowej $t_0$ tempo zmian MMI w surowicy krwi jest zerowe, zatem pierwsze równanie uk³adu \ref{eq:dxdt} przyjmuje postaæ: $0=s(t) - \dfrac{k_1 z_0 \cdot x_0}{k_a + x_0} - k_2 x_0$. Wyliczaj¹c z tej równoœci $z_0$, otrzymujemy:

\begin{equation}
\label{eq:z0}
z_{0} = \dfrac{(s(t) - k_{2}x_{0})(k_{a} + x_{0})}{k_{1}x_{0}}
\end{equation}

\section{Dane do symulacji}\label{sec:dane}

\begin{table}[]
\caption{Parametry modelu \ref{eq:uklad} wybranych pacjentów.}
\label{tab:pacjenci}
\begin{tabular}{|l|l|l|l|l|}
\hline
\textbf{Parametr} & \textbf{Pacjent nr 20} & \textbf{Pacjent nr 31} & \textbf{Pacjent nr 55} & \textbf{Pacjant nr 70} \\ \hline
$k_{1}$                & $8,374 \cdot 10^{3}$   & $8,374 \cdot 10^{3}$   & $8,374 \cdot 10^{3}$   & $8,374 \cdot 10^{3}$   \\ \hline
$k_{2}$                & 3,3271                 & 3,3272                 & 3,3273                 & 3,3274                 \\ \hline
$k_{a}$                & 0,358068               & 0,358068               & 0,358068               & 0,358068               \\ \hline
$k_{3}$                & 0,085                  & 0,08975                & 0,08992                & 0,11784                \\ \hline
$k_{d}$                & 0,067                  & 0,07                   & 0,081                  & 0,075                  \\ \hline
$k_{4}$                & 0,099021               & 0,099021               & 0,099021               & 0,099021               \\ \hline
$k_{5}$                & $10^{6}$               & $10^{6}$               & $10^{6}$               & $10^{6}$               \\ \hline
N                 & 0,25                   & 0,058                  & 0,207                  & 0,293                  \\ \hline
$k_{6}$                & 0,001                  & 0,001                  & 0,001                  & 0,001                  \\ \hline
$k_{7}$                & 0,26                   & 0,061                  & 0,22                   & 0,308                  \\ \hline
$k_{b}$                & 4,95                   & 11,8                   & 4,09                   & 3,15                   \\ \hline
$k_{8}$                & 0,035                  & 0,035                  & 0,035                  & 0,035                  \\ \hline
\end{tabular}
\end{table}

W niniejszej pracy przeprowadzono szereg symulacji modelu leczenia choroby Gravesa na podstawie danych do³¹czonych do artyku³u \cite{graves1}. Pochodz¹ one z badañ 23 pacjentów i zawieraj¹ informacje dotycz¹ce poziomu FT4, TRAb oraz dniu terapii w którym badanie zosta³o przeprowadzone.

Pe³na pula badañ obejmowa³a ponad 70 chorych, przy czym do analizy wybrano tych pacjentów, których badania by³y kompletne tzn. obejmowa³y pe³ny zestaw danych. U wielu pacjentów wystêpuj¹ braki dotycz¹ce badania TRAb, poniewa¿ przy wizycie kontrolnej, pomiar FT4 jest wystarczaj¹cy, do okreœlenia stadium choroby.

W przeprowadzonych symulacjach wykorzystano jedynie dane z pierwszej wizyty pacjenta. Pomiary w trakcie leczenia zosta³y u¿yte do weryfikacji poprawnoœci dzia³ania modelu.

Do analiz na potrzeby tej pracy, wykorzystano dane czterech pacjentów, zachowuj¹c ich oryginalne oznaczenia (pacjent nr 20, 31, 55, 70). Parametry dla wybranych pacjentów zosta³y przedstawione w tabeli (Tab. \ref{tab:pacjenci}).

\section{Stabilnoœæ uk³adu}

Przeanalizowano stabilnoœæ uk³adu \ref{eq:uklad} dla nieleczonej nadczynnoœci tarczycy, spowodowanej chorob¹ Gravesa. Analizê przeprowadzono w oparciu o twierdzenie o stabilnoœci uk³adu.

\subsection{Twierdzenie}  \label{sec:twierdzenie}
Niech funkcje $f_{i}(y_{1}, y_{2}, ..., y_{n})$ maj¹ ci¹g³e pochodne cz¹stkowe pierwszego rzêdu $(\dfrac{\partial f_{i}}{\partial y_{1}})$, gdzie $1\leq i,j\leq n$, w otoczeniu punkt równowagi $P=(a_{1},a_{2}, ..., a_{n})$ uk³adu. Dodatkowo niech 
\[
J(a_{1},a_{2}, ..., a_{n})
=
\begin{bmatrix}
(\dfrac{\partial f_{1}}{\partial y_{1}}) 
& (\dfrac{\partial f_{1}}{\partial y_{2}}) 
& \cdots 
& (\dfrac{\partial f_{1}}{\partial y_{n}}) \\

(\dfrac{\partial f_{2}}{\partial y_{1}}) 
& (\dfrac{\partial f_{2}}{\partial y_{3}}) 
& \cdots 
& (\dfrac{\partial f_{2}}{\partial y_{n}}) \\

\vdots & \vdots & \ddots & \vdots \\

(\dfrac{\partial f_{n}}{\partial y_{1}}) 
& (\dfrac{\partial f_{n}}{\partial y_{2}}) 
& \cdots 
& (\dfrac{\partial f_{n}}{\partial y_{n}}) 
\end{bmatrix},
\]
gdzie pochodne cz¹stkowe obliczane s¹ w punkcie $(a_{1},a_{2}, ..., a_{n})$.

Wówczas:
\begin{enumerate}
\item je¿eli wszystkie wartoœci w³asne macierzy Jacobiego J(P) maj¹ ujemne czêœci rzeczywiste, to punkt $P=(a_{1},a_{2}, ..., a_{n})$ jest asymptotycznie stabilnym punktem równowagi uk³adu
\item je¿eli co najmniej jedna wartoœæ w³asna macierzy J(P) ma dodatni¹ czêœæ rzeczywist¹, to punkt $P=(a_{1},a_{2}, ..., a_{n})$ jest niestabilnym punktem równowagi uk³adu autonomicznego.
\end{enumerate}

\subsection{Analiza stabilnoœci modelu}
Dla osoby zdrowej $s(t) = 0$ i uk³ad \ref{eq:uklad} przyjmuje postaæ:

\begin{equation} \label{eq:uklad_stab}
\left\lbrace 
\arraycolsep=1.5pt\def\arraystretch{2.2}
\begin{array}{ll}

\dfrac{dx}{dt} = \dfrac{(k_{1}z)x}{k_{a} + x} - k_{2}x\\

\dfrac{dy}{dt} = \dfrac{(k_{3}z)w}{k_{d} + w } - k_{4}y\\

\dfrac{dz}{dt} = k_{5} (\dfrac{w}{z} - N) - k_{6}zx\\

\dfrac{dw}{dt} = k_{7} - \dfrac{k_{7}x}{k_{b} + x} - k_{8}w\\
\end{array}
\right.
\end{equation}

Chc¹c sprawdziæ zachowanie siê modelu dla osoby zdrowej wyznaczamy punkty stacjonarne uk³adu

\begin{equation} \label{eq:funkcje_wielu_zmiennych}
\left\lbrace 
\arraycolsep=1.5pt\def\arraystretch{2.2}
\begin{array}{ll}

f(x, y, z, w) = \dfrac{(k_{1}z)x}{k_{a} + x} - k_{2}x\\

g(x, y, z, w) = \dfrac{(k_{3}z)w}{k_{d} + w } - k_{4}y\\

h(x, y, z, w) = k_{5} (\dfrac{w}{z} - N) - k_{6}zx\\

m(x, y, z, w) = k_{7} - \dfrac{k_{7}x}{k_{b} + x} - k_{8}w\\
\end{array}
\right.
\end{equation}

rozwi¹zuj¹c uk³ad równañ [ $ f(x, y, z, w) = 0 \wedge g(x, y, z, w) = 0 \wedge h(x, y, z, w) = 0 \wedge m(x, y, z, w) = 0$ ].

Dla osoby zdrowej otrzymujemy dok³adnie jeden punkt stacjonarny $E_{1} = (x_{1}, y_{1}, z_{1}, w_{1})$, gdzie
%Gdy nie podaje siê metimazolu $s(t)=0$, stan nadczynnoœci tarczycy opisuje siê jako $E_{1} = (x_{1}, y_{1}, z_{1}, w_{1})$, gdzie 

\begin{equation} \label{eq:e1}
\left\lbrace 
\arraycolsep=1.5pt\def\arraystretch{2.2}
\begin{array}{ll}

x_{1} = 0 \\

y_{1} = \dfrac{k_{3}k_{3}^{2}}{k_{4}k_{8}N(k_{8}k{d}+k{7})}  \\

z_{1} = \dfrac{k_{7}}{k_{8}N}\\

w_{1} = \dfrac{k_{7}}{k_{8}}

\end{array}
\right.
\end{equation}

Aby sprawdziæ stabilnoœæ punktu $E1$ wyznaczamy macierz Jacobiego $J(x,y,z,w)$ pochadnych cz¹stkowych funkcji f, g, h, m, tzn. macierz:

\[
J((x,y,z,w))
=
\begin{bmatrix}
\dfrac{-(k_{1}k_{a}z+k_{2}(x+k_{a})^2)}{(x+k_{a})^{2}} 
& 0 
& \dfrac{-xk_{1}}{(x+k_{a})} 
& 0 \\

0
& -k_{4} 
& \dfrac{wk_{3}}{w+k_{d}}
& \dfrac{zk_{3}k_{d}}{(w+k_{d})^{2}}  \\

-zk_{6} 
& 0
& \dfrac{-wk_{5}}{z^{2}} - xk_{6}
& \dfrac{k_{5}}{z} \\

\dfrac{-k_{7}k_{b}}{(x+k_{b})^{2}}
& 0
& 0
& -k_{8}

\end{bmatrix},
\]

Dla punktu $E_1$ otrzymujemy $J(E_1)$:

\[
J(E_1)
=
\begin{bmatrix}
-\dfrac{k_{1}k_{7}}{k_{8}Nk_{a}} - k_{2}
& 0 
& 0
& 0 \\

0
& -k_{4} 
& \dfrac{k_{3}k_{7}}{k_{8}k_{d}+k_{7}}
& \dfrac{k_{3}k_{7}k_{8}k_{d}}{N(k_{8}k_{d}+k_{7})^{2}} \\

-\dfrac{k_{6}k_{7}}{k_{8}N} 
& 0
& \dfrac{k_{5}k_{8}N^{2}}{k_{7}}
& \dfrac{k_{5}k_{8}N}{k_{7}} \\

\dfrac{k_{7}}{k_{b}}
& 0
& 0
& -k_{8}

\end{bmatrix},
\]

Wartoœci w³asne macierzy oblicza siê za pomoc¹ równania charakterystycznego macierzy w postaci $det(J(E_1) - \lambda I) = 0$. Wartoœci w³asne przedstawiaj¹ siê nastêpuj¹co:

\begin{equation} \label{eq:lambda}
\left\lbrace 
\arraycolsep=1.5pt\def\arraystretch{2.2}
\begin{array}{ll}

\lambda_{1} = -k_{4} \\

\lambda_{2} = -k_{8}  \\

\lambda_{3} = -\dfrac{k_{1}k_{7}}{k_{8}Nk_{a}} -k_{2} \\

\lambda_{4} = -\dfrac{k_{5}k_{8}N^2}{k_{7}}

\end{array}
\right.
\end{equation}

Wszystkie wartoœci w³asne maj¹ znak ujemny oraz parametry je opisuj¹ce s¹ dodatnie. Wynika z tego, ¿e wszystkie wartoœci w³asne macierzy $J(E_1)$ maj¹ ujemne czêœci rzeczywiste. Wed³ug twierdzenia o stabilnoœci uk³adu \ref{sec:twierdzenie}, uk³ad jest uk³adem asymptotycznie stabilnym.

%\emph{Przeprowadzenie symulacji wi¹¿e siê z kilkoma etapami. }
%
%\section{Problem 1}
%\emph{Stworzone no¿yczki powinny cechowaæ siê du¿¹ odpornoœci¹ na korozjê cyfrow¹. Mo¿na w~tym celu wykorzstaæ izolacjê od znaków wodnych (Rys.~\ref{f1}) na poziomie warstwy p³ótna.}
%
%\begin{figure}[H]
% \subfloat[Podpis 1\label{f1:c1}]{\includegraphics[width=0.45\textwidth]{logoPS}} \; % <--- to daje odstêp w poziomie; \\ daje now¹ linijkê
% \subfloat[Podpis 2\label{f1:c2}]{\includegraphics[width=0.45\textwidth]{logoRIB}} 
%  \caption{Podpis ca³oœci nawi¹zuj¹cy do podpisu \protect\subref{f1:c1}.\label{f1}} % wykorzystanie subref mo¿e wymagaæ dodania \protect !!!
%\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Czêœæ konstrukcyjna/Specyfikacja wewnêtrzna}
%Czêœæ konstrukcyjna lub implementacyjna, t³umacz¹ca sposób realizacji zadania, omówion¹ w poprzedniej czêœci opracowania. Wyjaœnienie wyborów elementów, sprzêtu lub programów. W przypadku programów obiektowych podzia³ na klasy, pola, metody wraz z uzasadnieniem.
%
%\emph{W trakcie realizacji zadania, w~pierwszym kroku, nale¿y odizolowaæ znaki wodne w~warstwie p³ótna. Wykorzystano w~tym celu dostêpn¹ w~œrodowisku XYZ funkcje Z. Parametry do funkcji okreœlono poprez\ldots}

Projekt zosta³ zrealizowany w programie MATLAB. Jest to œrodowisko do wykonywania obliczeñ naukowych i in¿ynierskich, oraz do tworzenia symulacji komputerowych \cite{matlab}. Do utworzenia graficznego interfejsu, u¿yto stosunkowo nowego narzêdzia programu MATLAB - œrodowiska Appdesigner.

\section{Klasy aplikacji}
\begin{table}[]
\caption{Klasy aplikacji.}
\label{tab:interfejsy}
\begin{tabular}{|p{4cm}|p{10.5cm}|}

\hline
\textbf{Nazwa klasy} & \textbf{Opis}                                                                                                                  \\ \hline
Patient          & Parametry pacjenta oraz wyniki pierwszego badania FT4 i TRAb.                                     \\ \hline
Dose             & Iloœæ metimazolu i czasu dawki leczenia.                                                                      \\ \hline
InitialValues    & Warunki pocz¹tkowe symulacji.                                                                       \\ \hline
StabilityPoint   & Punkty stacjonarne uk³adu.
\\ \hline
Eigen            & Wartoœci w³asne uk³adu.                                                                            \\ \hline
T                & Wektor z punktami czasowymi symulacji.                                                                                         \\ \hline
X                & Rozwi¹zania równañ ró¿niczkowych.
 \\ \hline
StartData        & Wszystkie pola i struktury potrzebne do startu aplikacji.                                                                      \\ \hline
Simulation       & Wszystkie pola i struktury potrzebne do rozpoczêcia symulacji.                                                                 \\ \hline
SimulationResult & Wszystkie pola i struktury potrzebne do wyœwietlenia wyników symulacji.                                                        \\ \hline
\end{tabular}
\end{table}
Utworzono kilka klas, których opis zawarto w tabeli (Tab. \ref{tab:interfejsy}).



Aplikacja przesy³a dane g³ównie pomiêdzy dwoma widokami:
\begin{enumerate}
\item App - Widok w którym aplikacja jest inicjalizowana. Wczytujemy dane, wybieramy szczegó³y symulacji oraz j¹ rozpoczynamy.
\item SimulationView - Widok w którym obserwujemy symulacjê.
\end{enumerate}

\section{Przep³yw danych w aplikacji}
Do przekazania danych pomiêdzy widokami aplikacji, s³u¿¹ g³ównie trzy klasy. S¹ to:
\begin{enumerate}
\item StartData (Rys.~\ref{start_data_img}),
\item Simulation (Rys.~\ref{i-simulation_img}),
\item SimulationResult (Rys.~\ref{simulation_result_img}).
\end{enumerate}

\begin{figure}
	\centering
	\includegraphics[width=0.7\textwidth]{visio/start_data}
	\caption{Klasa StartData.}\label{start_data_img}
\end{figure}

\begin{figure}
	\centering
	\includegraphics[width=\size\textwidth]{visio/simulation}
	\caption{Klasa Simulation.}\label{i-simulation_img}
\end{figure}

\begin{figure}
	\centering
	\includegraphics[width=\size\textwidth]{visio/simulation_result}
	\caption{Klasa SimulationResult.}\label{simulation_result_img}
\end{figure}

\section{Metody utworzonego programu}\label{sec:methods}

\subsubsection*{Simulate}
Metoda \textit{Simulate} zajmuje siê wszystkimi obliczeniami zwi¹zanymi z symulacj¹. Przyjmuje obiekt typu Simulation (Rys. \ref{i-simulation_img}) i zwraca SimulationResult (Rys. \ref{simulation_result_img}).
\begin{lstlisting}
function SimulationResult = Simulate(Simulation)
\end{lstlisting}

\subsubsection*{UkladRownan}
Metoda \textit{UkladRownan} przyjmuje chwilê czasow¹ t, warunki pocz¹tkowe modelu, parametry pacjenta oraz dawki leczenia. Metoda ta jest wykorzystywana przez solver ode45 do symulacji modelu w ka¿dej chwili czasowej t. Zwraca rozwi¹zania uk³adu równañ ró¿niczkowych \ref{eq:uklad}.
\begin{lstlisting}
function rownania = UkladRownan(t, InitialValuesVector, PatientVector, DoseVector)
\end{lstlisting}


\subsubsection*{TreatmentDose}
Metoda \textit{TreatmentDose} przyjmuje dawki leku, d³ugoœæ terapii w dniach oraz chwilê czasow¹ t. Metoda ta jest wykorzystywana przez solver \textit{ode45}, do obliczania przyjmowanej dawki MMI czyli wartoœci funkcji s(t).
\begin{lstlisting}
function s = TreatmentDose(DOSES, DAYS, t)
\end{lstlisting}

\subsubsection*{StabilityPoints}
Metoda \textit{StabilityPoints} przyjmuje parametry pacjenta i zwraca stabilny punkt stacjonarny w przestrzeni 4-wymiarowej.
\begin{lstlisting}
function points = StabilityPoints(patient)
\end{lstlisting}


\subsubsection*{JacobainMatrix}
Metoda \textit{JacobainMatrix} przyjmuje parametry pacjenta i warunki pocz¹tkowe. Zwraca macierz Jacobiego dla danego uk³adu.
\begin{lstlisting}
function matrix = JacobainMatrix( patient, initialValues )
\end{lstlisting}

\subsubsection*{ConvertStringToNArray}
Metoda \textit{ConvertStringToNArray} konwertuje napis na tablicê liczb. Jako, ¿e jest to osobna metoda w programie, zosta³a sprawdzona testem jednostkowym.
\begin{lstlisting}
function [arrayOutput] = ConvertStringInputToNArray(textInput)
\end{lstlisting}

\subsubsection*{Test\_convertStringInputToNArray}
Test jednostkowy - implementacja skryptu:
\begin{lstlisting}
input = '10, 12, 20, 30';
expected = [10 12 20 30 0]; % N element array

result = ConvertStringInputToNArray(input, 5);

if isequal(result, expected)
    disp('convertStringInputToNArray correct!'); 
else
    disp('convertStringInputToNArray failed!'); 
end
\end{lstlisting}

\subsubsection*{ParsingErrorDialog}
Niektóre z wprowadzanych danych s¹ napisami, dlatego aplikacja jest zabezpieczona metod¹ \textit{ParsingErrorDialog} przed niepoprawnymi wpisami. U¿ytkownik otrzymuje stosowne powiadomienie o b³êdzie.
\begin{lstlisting}
function ParsingErrorDialog(axis)
\end{lstlisting}

\subsubsection*{ShowSimulation}
Do narysowania przebiegów czasowych rozwi¹zañ modelu \ref{eq:uklad} s³u¿y metoda \textit{ShowSimulation}. Jako parametry przyjmuje ona wykres (UIAxes), dane do wykreœlenia (T, X) oraz tytu³ wykresu (pLabel).
\begin{lstlisting}
function ShowSimulation( UIAxes, T, X, pLabel )
\end{lstlisting}


\subsubsection*{PrintFigure}
Appdesigner nie obs³uguje zaawansowanej manipulacji wykresami, dlatego do zapisania wykresu nale¿y utworzyæ figurê typu widmo, kopiuj¹c wszystkie informacje z poprzedniego wykresu. S³u¿y do tego metoda \textit{PrintFigure}.
\begin{lstlisting}
function PrintFigure(plotFigure, name)
\end{lstlisting}

\subsubsection*{PlotPhase}
Do narysowania portretów fazowych symulacji, s³u¿y metoda \textit{PlotPhase}.
\begin{lstlisting}
function PlotPhase(ax, x, y, px, py, xlab, ylab)
\end{lstlisting}

\subsubsection*{FindFT4NormalRange}
\textit{FindFT4NormalRange} jest funkcj¹ dodatkow¹. Nie jest zaimplementowana w graficznym interfejsie aplikacji. Wypisuje w konsoli programu Matlab iloœæ dni, po których pacjent, osi¹ga graniczny poziom FT4, dla osoby zdrowej.
\begin{lstlisting}
function timeUpFT4 = FindFT4NormalRange(T, X)
\end{lstlisting}

\section{Wykorzystane funkcje programu Matlab} \label{sec:functions}
\subsubsection*{Ode45}

Do rozwi¹zywania uk³adu równañ ró¿niczkowych \ref{eq:uklad} u¿yto wbudowanej funkcji Matlaba \textbf{ode45}. Pocz¹tkowo u¿yto bazowej wersji funkcji ode45:

\begin{lstlisting}
[t,y] = ode45(odefun(t,y,A,B),tspan,y0)
\end{lstlisting}

Parametry funkcji:
\begin{itemize}
\item odefun - funkcja zwracaj¹ca równania ró¿niczkowe w chwili t \ref{sec:methods},
\item tspan - przedzia³ czasowy symulacji,
\item y0 - warunki pocz¹tkowe uk³adu \ref{eq:uklad},
\item A i B - wektory dodatkowych parametrów.
\end{itemize}

Funkcja \textit{ode45} zwraca wektor [t,y] gdzie:
\begin{itemize}
\item t - wektor czasu,
\item y - wektor rozwi¹zañ uk³adu równañ ró¿niczkowych \ref{eq:uklad}.
\end{itemize}

W celu optymalizacji wykorzystywanej przez program pamiêci u¿yto przeci¹¿enia metody \textit{ode45}, która mo¿e przyj¹æ dodatkowe parametry A i B, bez umieszczania ich w macierzy wynikowej y. Za pomoc¹ parametrów A, B przekazywane s¹ dane wybranego pacjenta oraz dawki leku. Dziêki takiemu rozwi¹zaniu, symulacja wykorzystuje czterokrotnie mniej miejsca pamiêci RAM.
\begin{lstlisting}
[t,y] = ode45(@(t,y) odefcn(t,y,A,B), tspan, y0);
\end{lstlisting}

\subsubsection*{Eig}
\begin{lstlisting}
e = eig(A)
\end{lstlisting}
Funkcja \textit{eig} przyjmuje jako parametr macierz kwadratow¹ A, zaœ zwraca wektor kolumnowy z wartoœciami w³asnymi macierzy A.

\subsubsection*{Solve}
\begin{lstlisting}
results = solve(eqns, syms);
\end{lstlisting}
Funkcja \textit{Solve} rozwi¹zuje uk³ad równañ u¿ywaj¹c zmiennych symbolicznych. Przyjmuje dwa parametry:
\begin{itemize}
\item eqns - tablicê równañ,
\item syms - tablicê zmiennych symbolicznych u¿ytych w równaniach.
\end{itemize}
Funkcja zwraca wyniki dla zmiennych symbolicznych.

\subsubsection*{Find}
\begin{lstlisting}
k = find(X,n,direction)
\end{lstlisting}
Funkcja \textit{find} przeszukuje wartoœci tablicy lub listy, zwracaj¹c indeksy, dla których równanie jest prawdziwe. Jako argumenty przyjmuje trzy zmienne:
\begin{itemize}
\item X - równanie zawieraj¹ce tablicê do przeszukania i zmienn¹ do której przyrównuje,
\item n - iloœæ indeksów, które pierwsze zostan¹ przyporz¹dkowane,
\item direction - kierunek przyporz¹dkowania.
\end{itemize}

\subsubsection*{Strsplit}
\begin{lstlisting}
C = strsplit(str,delimiter)
\end{lstlisting}
Funkcja \textit{strsplit} dzieli napis na tablicê napisów w miejscach okreœlonego znaku i zwraca tablicê napisów. Parametry funkcji to:
\begin{itemize}
\item str - napis,
\item delimeter - znak, w którego miejscach napis jest roz³¹czany.
\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Instrukcja obs³ugi/Specyfikacja zewnêtrzna}
W tej czêœci zostanie szczegó³owo omówiony program autora pracy wraz z instrukcj¹ jego obs³ugi.

\section{Okno g³ówne aplikacji}
Rys. \ref{window1_img} przedstawia g³ówne okno aplikacji. S³u¿y ono do konfiguracji symulacji, któr¹ mo¿na podzieliæ na trzy czêœci: wybór pacjenta, wybór parametrów symulacji, warunki pocz¹tkowe.

\begin{figure}
	\centering
	\includegraphics[width=1\textwidth]{specs/window1}
	\caption{Okno g³ówne aplikacji.}\label{window1_img}
\end{figure}

\subsection{Wybór pacjenta}
W pierwszej czêœci symulacji (Rys.~\ref{choose-patient_img}), u¿ytkownik wybiera jednego z czterech analizowanych w pracy pacjentów (Rys. \ref{patient-list_img}), dla którego przeprowadzone zostan¹ symulacje. Parametry, charakterystyczne dla tego pacjenta zamieszczone s¹ w tabeli. Dodatkowych pacjentów nale¿y dodaæ z poziomu kodu.

\begin{figure}
	\centering
	\includegraphics[width=0.4\textwidth]{specs/choose-patient}
	\caption{Wybór pacjenta.}\label{choose-patient_img}
\end{figure}

\begin{figure}
	\centering
	\includegraphics[width=0.4\textwidth]{specs/patient-list}
	\caption{Lista wyboru pacjenta.}\label{patient-list_img}
\end{figure}

\subsection{Wybór parametrów symulacji}
Ta czêœæ s³u¿y do wyboru parametrów symulacji (Rys. \ref{conf:simulation_img}): czasu, leczenia i dawki metimazolu. W pierszym polu u¿ytkowanik wpisuje czas symulacji wyra¿ony w dniach. U¿ywaj¹c w³¹cznika wybieramy leczenie lub jego brak. W³¹czenie terapii aktywuje pole dawki leku, w którym wybieramy iloœæ metimazolu, jak¹ codziennie przyjmuje pacjent.

Terapie mog¹ byæ bardzo skomplikowane, dlatego istnieje mo¿liwoœæ utworzenia schematu leczenia. Wystarczy wpisaæ we wskazane pola kilka wartoœci po przecinku. Dla u³atwienia wprowadzania dawek, poni¿ej umieszczono trzy dodatkowe przyciski (Rys. \ref{conf:simulation_img}). Pierwsze dwa: \textit{Simple Dose} i \textit{Advanced Dose}, automatycznie wpisuj¹ w pole \textit{Dose} domyœlne, przyk³adowe terapie. Trzeci przycisk \textit{Info} informuje, jak wype³niaæ pola. Na rysunku (Rys. \ref{adv-treatment_img}) pokazano wprowadzenie przyk³adowego zaawansowanego schematu terapii.

\begin{figure}
	\centering
	\includegraphics[width=0.4\textwidth]{specs/simulation}
	\caption{Konfiguracja symulacji bez leczenia.}\label{conf:simulation_img}
\end{figure}

\begin{figure}
	\centering
	\includegraphics[width=0.4\textwidth]{specs/adv-treatment}
	\caption{Konfiguracja zaawansowanego leczenia.}\label{adv-treatment_img}
\end{figure}

\subsection{Warunki pocz¹tkowe}

Wprowadzenie warunków pocz¹tkowych odbywa automatycznie, po wyborze pacjenta (Rys. \ref{initial_img}). Poziom FT4, przeciwcia³ i wielkoœæ komórek tarczycy ustalaj¹ siê po wyborze pacjenta, zaœ pole MMI ustawia siê po wybraniu dawki. 

\begin{figure}
	\centering
	\includegraphics[width=0.4\textwidth]{specs/initial}
	\caption{Przyk³adowe warunki pocz¹tkowe.}\label{initial_img}
\end{figure}

\subsection{Symulacja}
Naciœniêcie przycisku \textit{Simulate}, rozpoczyna symulacjê. Przebieg symulacji potwierdza okno modalne z paskiem postêpu (Rys. \ref{progressbar_img}).
\begin{figure}
	\centering
	\includegraphics[width=0.6\textwidth]{specs/progressbar}
	\caption{Okno modalne oczekiwania na obliczenia.}\label{progressbar_img}
\end{figure}

\section{Okno wyników symulacji}
Okno wyników symulacji (Rys. \ref{window2_img}) pojawia siê po wykonaniu obliczeñ. Po lewej stronie otrzymujemy przebiegi czasowe rozwi¹zañ modelu, zaœ po prawej wykresy zale¿noœci, które mo¿emy  ustaliæ wybieraj¹c z paska kart odpowiednio odciêt¹ oraz rzêdn¹. Nadrzêdna karta \textit{Details} wyœwietla tak¿e szczegó³owe informacje o konfiguracji bie¿¹cej symulacji.

\begin{figure}
	\centering
	\includegraphics[width=1\textwidth]{specs/window2}
	\caption{Okno wyników symulacji.}\label{window2_img}
\end{figure}

\subsection{Graficzne przedstawienie wyników symulacji}
Przyk³adow¹ symulacjê leczenia pacjenta przedstawia rys. \ref{w2-simulation_img}. Wykres zawiera obszerny tytu³ z istotnymi informacjami dotycz¹cymi terapii pacjenta. Ka¿da z funkcji stanu, jest narysowana odmiennym kolorem. Dla u³atwienia rozpoznania stadium choroby, przerywanymi poziomymi liniami zosta³y zaznaczone standardowe iloœci FT4 dla osoby zdrowej. Do wykresu do³¹czona jest legenda.

\begin{figure}
	\centering
	\includegraphics[width=0.8\textwidth]{specs/w2-simulation}
	\caption{Przyk³adowe przebiegi czasowe rozwi¹zañ modelu dla wskazanego w tytule schematu terapii.}\label{w2-simulation_img}
\end{figure}

Nad wykresem znajduj¹ siê dwa przyciski \textit{Figure} oraz \textit{Print~\&~Copy}. \textit{Figure} deleguje wykres do zaawansowanego narzêdzia edycji wykresów (Rys. \ref{figure-gui_img}). Przycisk \textit{Print \& Figure} zapisuje wykres w katalogu programu, ze szczegó³ow¹ nazw¹ pliku oraz kopiuje go do schowka (Rys. \ref{img-path_img}).

\begin{figure}
	\centering
	\includegraphics[width=0.8\textwidth]{specs/figure-gui}
	\caption{Narzêdzie edycji wykresów.}\label{figure-gui_img}
\end{figure}

\begin{figure}
	\centering
	\includegraphics[width=0.8\textwidth]{specs/img-path}
	\caption{Zapisane w katalogu pliki wyników symulacji.}\label{img-path_img}
\end{figure}

\subsection{Portrety fazowe oraz szczegó³y symulacji}
Prawa czêœæ okna wyników symulacji zawiera dwie zak³adki: \textit{Phase portrait} oraz \textit{Details}. Domyœlnie wyœwietlana jest zak³adka \textit{Phase portrait} (Rys.~\ref{portrait_img}), zawieraj¹ca rzut portretu fazowego na okreœlon¹ przestrzeñ dwuwymiarow¹. Dla funkcji okreœlonej w przestrzeni czterowymiarowej, takich rzutów portretów na przestrzeñ dwuwymiarow¹ jest 8.

\begin{figure}
	\centering
	\includegraphics[width=0.8\textwidth]{specs/portrait}
	\caption{Przyk³adowy wykres zale¿noœci TS(MMI).}\label{portrait_img}
\end{figure}

Po naciœniêciu zak³adki \textit{Details}, otwiera siê czêœæ informuj¹ca u¿ytkownika o szczegó³ach symulacji oraz o wartoœciach w³asnych Jacobianu w punkcie stacjonarnym (Rys.~\ref{details_img}), obliczonych dla wybranego pacjenta w przypadku braku leczenia.

\begin{figure}
	\centering
	\includegraphics[width=0.5\textwidth]{specs/details}
	\caption{Szczegó³y symulacji oraz wyznaczone wartoœci w³asne Jacobianu w punkcie stacjonarnym dla przypadku braku terapi.}\label{details_img}	
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Rezultaty} \label{sec:result}
%Zobrazowanie i omówienie wyników otrzymywanych wskutek zastosowania danego urz¹dzenia b¹dŸ aplikacji. Badanie ewentualnych parametrów (takich jak dok³adnoœæ, czu³oœæ...), czy te¿ zachowania w szczególnych sytuacjach. O ile to mo¿liwe tabelaryzacja rezultatów oraz ich statystyczna interpretacja. Ocena zachowania zaproponowanego rozwi¹zania. Analiza mo¿liwych przyczyn wyst¹pienia b³êdów. 

W oparciu o program napisany przez autora pracy, symulowano ró¿ne scenariusze terapii pacjentów. Do analizy modelu u¿yto danych czterech pacjentów (Rozdzia³. \ref{sec:dane}), zmagaj¹cych siê z nadczynnoœci¹ tarczycy Gravesa—Basedowa. W tej czêœci pracy zosta³y przedstawione symulacje leczenia chorych. 

\section{Wstêpne porównanie pacjentów}

Na wykresie (Rys.~\ref{pacjenci_FT4_trab_img}) porównano analizowanych pacjentów, ze wzglêdu na zmierzone wartoœci FT4 i TRAb. Badanie mia³o miejsce podczas pierwszej wizyty u lekarza. 

Na najsilniejsz¹ nadczynnoœæ tarczycy, zgodnie z poziomem hormonu FT4, cierpi pacjent numer 70. Potwierdza to równie¿ najwy¿szy poziom przeciwcia³ TRAb w jego krwi. Poziom FT4 pozosta³ych pacjentów jest zbli¿ony. Pacjent numer 30 ma znacz¹co ni¿sz¹ wartoœæ przeciwcia³. Jego organizm mo¿e byæ bardzo czu³y na wystêpowanie przeciwcia³ lub nadczynnoœæ jest spowodowana innym czynnikiem.

\begin{figure}
	\centering
	\includegraphics[width=1\textwidth]{excel/pacjenci_FT4_trab}
	\caption{Porównanie poziomów FT4 i TRAb analizowanych pacjentów.}\label{pacjenci_FT4_trab_img}
\end{figure}

\section{Pacjent numer 20}

\begin{figure}
	\centering
	\includegraphics[width=\size\textwidth]{wyniki/p20_no_dose_d10}
	\caption{Symulacja pacjenta nr 20 bez leczenia, trwaj¹ca 10 dni.}\label{p20_no_dose_img}
\end{figure}

Na pocz¹tku przeanalizowano stan pacjenta, bez podania leku. Poziom FT4 tego pacjenta wynosi³ 25,63 pg/ml, co jest znacznie powy¿ej normy (7-18 pg/ml). Dowodzi to faktu, i¿ pacjent ten cierpi na nadczynnoœæ tarczycy. Podczas symulacji trwaj¹cej 10 dni, przebiegi czasowe rowi¹zañ modelu, czyli poziom MMI, FT4, rozmiar komórek gruczo³u i TRAb s¹ funkcjami sta³ymi, czyli nie zmieniaj¹ siê w czasie. Mo¿na to zaobserwowaæ na rysunku (Rys.~\ref{p20_no_dose_img}). Wraz z czasem d¹¿¹cym do nieskoñczonoœci sytuacja nie ulega zmianie. Wynika to z faktu, ¿e przy braku terapii, model jest asymptotycznie stabilny.

\begin{figure}
	\centering
	\includegraphics[width=\size\textwidth]{wyniki/p20_dose30_d1}
	\caption{Symulacja pacjenta nr 20, leczonego 30 mg leku, przez jeden dzieñ.}\label{p20_dose30_d1_img}
\end{figure}

Po jednorazowym podaniu 30 mg MMI (Rys.~\ref{p20_dose30_d1_img}), lek zostaje ca³kowicie wydalony z organizmu w czasie jednego dnia. Ta dawka nie ma znacz¹cego wp³ywu na funkcje tarczycy. 
 
\begin{figure}
	\centering
	\includegraphics[width=\size\textwidth]{wyniki/p20_dose30_d120}
	\caption{Symulacja pacjenta nr 20, leczonego 30 mg leku, przez 120 dni.}\label{p20_dose30_d120_img}
\end{figure}

Przy podawaniu 30 mg leku przez 120 dni, stan gospodarki hormonalnej tarczycy pacjenta, znacz¹co siê zmieni³ (Rys.~\ref{p20_dose30_d120_img}). Po oko³o 30 dniach, poziom FT4 pacjenta osi¹gn¹³ graniczny stan dla osoby zdrowej. Kontynuowanie terapii przy tej samej dawce, skutkuje ci¹g³ym obni¿aniem siê poziomu tego hormonu i po 90 dniach osi¹ga poziom œwiadcz¹cy o niedoczynnoœci tarczycy.

\begin{figure}
	\centering
	\includegraphics[width=\size\textwidth]{wyniki/p20_dose30_d75_dose0_d45}
	\caption{Symulacja pacjenta nr 20 podczas leczenia i odstawienia leku.}\label{p20_dose30_d75_dose0_d45_img}
\end{figure}
  
Jak pokazano na rys.~\ref{p20_dose30_d75_dose0_d45_img} przy podawaniu dawki 30 mg przez 75 dni i nastêpnie odstawieniu leku, pacjent powróci³ do stanu nadczynnoœci tarczycy. Trwa³o to oko³o 35 dni.  Taki scenariusz leczenia, okaza³ siê nieskuteczny co oznacza, ¿e pacjent wymaga nastêpnej serii leczenia.

\begin{figure}
	\centering
	\includegraphics[width=\size\textwidth]{wyniki/p20_treatment}
	\caption{Symulacja dla pacjenta nr 20, przyk³adowa terapia, odstawienie i wznowienie terapii.}\label{p20_treatment_img}
\end{figure}

Rys. \ref{p20_treatment_img} przedstawia przyk³adow¹ terapiê dedykowan¹ dla pacjenta nr 20. Podczas leczenia dawk¹ 30 mg metimazolu przez 2 miesi¹ce, stê¿enie FT4 pacjenta osi¹gnê³o górn¹ graniczn¹ wartoœæ po 27 dniach. Po 60 dniach stê¿enie to wynosi³o 12,3 pg/ml, dlatego postanowiono zwiêkszyæ dawkê metizamolu do 40 mg dziennie. Graniczna wartoœæ zosta³a osi¹gniêta po 25 dniach, a stê¿enie FT4 pod koniec tego etapu terapii wynios³o 10,97 pg/ml. Nastêpnie zmniejszono dawkê do 20 pg/ml i dalej do 10 pg/ml. Po tym okresie trwaj¹cym 4 miesi¹ce, nale¿y sprawdziæ czy choroba jest w stadium reemisji. Jeœli tak, nale¿y zacz¹æ kolejny etap leczenia, stosuj¹c taki sam schemat dawkowania.

W artykue A. Prakash'a \cite{mmi}, opisane zosta³y ró¿ne metody leczenia choroby Gravesa. Niektóre z badañ wskazuj¹, ¿e du¿e dawki metimazolu i krótka terapia zwiêkszaj¹ ryzyko wyst¹pienia nawrotów choroby. Optymalna d³ugoœæ terapii powinna wynosiæ 12-18 miesiêcy. Przy 18-miesiêcznej terapii, ryzyko nawrotu choroby to 37\%. 6-miesiêczna terapia wywo³a nawrót u 58\% leczonych.

Stosuj¹c siê do zaleceñ zawartych w artykule \cite{mmi}  opracowano terapiê dla pacjenta nr 20 (Rys.~\ref{p20_treatment1_img}). Podczas 12 miesiêcy co 2 miesi¹ce dawka leku jest zmniejszana. Podawane s¹ dawki 30 mg MMI przez 2 miesi¹ce, 20 mg przez 2 miesi¹ce, 15 mg przez 2 miesi¹ce i 5 mg przez 6 miesiêcy. W efekcie zaproponowanej terapii hormon FT4 pacjenta osi¹ga poziom  FT4 cz³owieka zdrowego po 27 dniach leczenia.

\begin{figure}
	\centering
	\includegraphics[width=\size\textwidth]{wyniki/p20_treatment1}
	\caption{Symulacja dla pacjenta nr 20, sugerowana 12-miesiêczna terapia.}\label{p20_treatment1_img}
\end{figure}

\section{Pacjent numer 31}

Pacjent numer 31 jest odmiennym przypadkiem w odniesieniu do innych pacjentów, gdy¿ poziom jego przeciwcia³ jest niski przy podobnym stê¿eniu FT4. Symulacje wykaza³y (Rys. ~\ref{p31_treatment_img}), ¿e jest ma³o wra¿liwy na leczenie metimazolem. Dla tego pacjenta, warto rozpatrywaæ alternatywne metody leczenia. Sugerowane leczenie obejmuje wiêksze dawki leku (Rys.~\ref{p31_treatment_img}). Trwa ono 18 miesiêcy, przy czym ostatnie 6 miesiêcy, pacjent pobiera dawkê 10 mg MMI. Podawane s¹ dawki 40 mg MMI przez pierwsze 3 miesi¹ce, nastêpnie 30 mg przez 4 miesi¹ce, 20 mg przez 5 miesiêcy i 10 mg przez ostatnie 6 miesiêcy.

\begin{figure}
	\centering
	\includegraphics[width=\size\textwidth]{wyniki/p31_treatment}
	\caption{Symulacja dla pacjenta nr 31, sugerowana 18-miesiêczna terapia.}\label{p31_treatment_img}
\end{figure}


\section{Pacjent numer 55}

\begin{figure}
	\centering
	\includegraphics[width=\size\textwidth]{wyniki/p55_treatment}
	\caption{Symulacja pacjenta nr 55, sugerowana 12-miesiêczna terapia.}\label{p55_treatment_img}
\end{figure}

Rys.~\ref{p55_treatment_img} przedstawia sugerowan¹ terapiê dla pacjenta numer 55. Zastosowano to samo leczenie, co w przypadku pacjenta nr 20 (Rys.~\ref{p20_treatment_img}). Podczas 12 miesiêcy co 2 miesi¹ce dawka leku jest zmniejszana. Podawane s¹ dawki 30, 20, 15 i 5 mg MMI. Dawka podtrzymuj¹ca leczenie wynosi 5 mg i jest podawana przez ostatnie 6 miesiêcy terapii. Pacjent osi¹ga poziom FT4 odpowiadaj¹cy górnej granicy FT4 dla osoby zdrowej po 29 dniach.

\section{Pacjent numer 70}

Pacjent nr 70 ma najwy¿szy pocz¹tkowy poziom hormonu FT4. Proponowana terapia trwa 14 miesiêcy (Rys.~\ref{p70_treatment_img}). Jako, ¿e jego poziom FT4 koreluje z wysokim poziomem przeciwcia³ TRAb, chory dobrze reaguje na leczenie. Przez pierwsze 2 miesi¹ce stosujemy dawkê 30 mg/dziennie, nastêpnie zmniejszamy dawkê do 20 i 15 mg, co 3 miesi¹ce. Jako dawkê podtrzymuj¹c¹ terapiê podajemy 5 mg leku przez 6 miesiêcy. Pacjent osi¹ga poziom FT4 odpowiadaj¹cy górnej granicy FT4 dla osoby zdrowej po 42 dniach.

\begin{figure}
	\centering
	\includegraphics[width=\size\textwidth]{wyniki/p70_treatment}
	\caption{Symulacja dla pacjenta nr 70, sugerowana 14-miesiêczna terapia.}\label{p70_treatment_img}
\end{figure}

\section{Porównanie zapotrzebowania na lek}

W niniejszym paragrafie przeanalizowano zapotrzebowanie na lek omawianych w pracy pacjentów. Zsumowano iloœæ przyjêtego leku, podczas sugerowanego leczenia, przez okres pierwszych 360 dni. Dla pacjentów nr 20, 31 jest to koniec terapii. Wyniki przedstawione zosta³y na rys.~\ref{pacjenci_mmi_img}. 3/4 pacjentów przyjmie oko³o 5 g leku przez 12 miesiêcy. Pacjent numer 31 musi przyj¹æ 10 g leku przez 12 miesiêcy oraz bêdzie kontynuowa³ leczenie przez kolejnych 6 miesiêcy.

\begin{figure}
	\centering
	\includegraphics[width=1\textwidth]{excel/pacjenci_mmi}
	\caption{Porównanie zapotrzebowania na lek pacjentów.}\label{pacjenci_mmi_img}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Podsumowanie}

\section{Wnioski}
\begin{itemize}
\item Model pozwala symulowaæ terapie, jednak wyznaczenie parametrów $k_5$, $k_6$ polega na minimalizacji b³êdu œredniokwadratowego wzglêdem poprzednich terapii pacjenta \ref{sec:params}. W zwi¹zku z tym, niemo¿liwe jest stosowanie symulacji, dla pacjentów podczas ich pierwszej wizyty, a iloœæ wczeœniejszych terapii zwiêksza dok³adnoœæ modelu.

\item Poniewa¿ parametry $k_5$ i $k_6$ s¹ symulowane, modelu nie mo¿na zastosowaæ we wspomaganiu terapii pacjenta, gdy¿ indywidualnoœæ ich wyznaczania jest czasoch³onna i korzysta z danych konkretnego pacjenta z poprzednich terapii. Jednak, jeœli wyznaczymy te parametry, model powinien znacz¹co podnieœæ efektywnoœæ terapii, poprzez dobranie optymalnej œcie¿ki leczenia, dawek oraz pozwoliæ efektywnie zaplanowaæ kolejne wizyty, zmniejszaj¹c tym samym iloœæ badañ oraz orzekaæ o reemisji lub wyleczeniu z wiêkszym prawdopodobieñstwem \ref{sec:result}.

\item W porównaniu do modelu skonstruowanego przez Langensteinam \cite{old-model} model zastosowany w pracy Pandiyan \cite{graves1}, który bazuje na pracy poprzednika, pozwala obserwowaæ przebieg czasowy metimazolu w krwi. Wprowadza to wiele niedomówieñ oraz symulacje, które dotycz¹ ró¿nych d³ugoœci terapii nie s¹ zbie¿ne. Nieintuicyjnym lub niemo¿liwym jest te¿  wyznaczenie prawdopodobieñstwa reemisji, dla symulowanej terapii.

\item Symulacja przebiegów czasowych nie jest czynnikiem, który bezpoœrednio wp³ywa na efektywnoœæ terapii pacjenta. Wa¿niejszym jest wyznaczenie prawdopodobieñstwa reemisji wzglêdem terapii. W leczeniu choroby Gravesa, dobór w³aœciwych dawek i oscylacja miêdzy prawid³owymi poziomami FT4 mo¿e pozytywnie wp³ywaæ na ca³kowite wyleczenie, jednak hipoteza ta musi zostaæ przebadana w przysz³oœci.

\item Symulacja przebiegów czasowych pozwala na w³aœciwy dobór dawek leczenia, sprawiaj¹c, ¿e gospodarka hormonalna uk³adu tarczycowego bêdzie funkcjonowa³a tak, jak u cz³owieka zdrowego \ref{sec:result}. Znacz¹co zmniejsza siê ryzyko przedawkowania leku, które mo¿e doprowadziæ do niedoczynnoœci tarczycy lub zwiêkszenia efektów ubocznych przyjmowania metimazolu. Wp³ywa na zdrowie i komfort ¿ycia pacjenta.

\item Optymalizacja kodu, poprzez stosowanie w³aœciwych metod, mo¿e znacz¹co zwiêkszyæ wydajnoœæ aplikacji i zmniejszyæ zu¿ycie zasobów. Zastosowanie przeci¹¿enia metody, pozwoli³o zmniejszyæ zapotrzebowanie na pamiêæ RAM czterokrotnie i znacz¹co skróci³o obliczenia \ref{sec:functions}. Pozwoli³o to na wykonanie wiêkszej liczby symulacji. 
\end{itemize}
%Nawi¹zanie do celu pracy oraz postawionych za³o¿eñ. Próba oceny realizacji celu, poprzez weryfikacjê otrzymanych rezultatów. Analiza dostrze¿onych problemów, b³êdnego, nieoczekiwanego dzia³ania, ewentualnych problemów napotkanych podczas realizacji. W przypadku niewyczerpania tematu, a tak¿e wspomnianego niepo¿¹danego zachowania urz¹dzenia/aplikacji sugestie ich eliminacji wymienione jako plany na przysz³oœæ.\footnote{Krótkie! 1-2 strony.}
%
%Wstêp wraz z podsumowaniem winny stanowiæ swego rodzaju klamrê, a nawet ca³oœæ w takim rozumieniu, ¿e przeczytanie wy³¹cznie tych dwóch rozdzia³ów t³umaczyæ powinno rozwa¿any problem wraz z efektami otrzymanymi w efekcie prac, stanowi¹cymi jego rozwi¹zanie, bez wnikania w sposób ich otrzymania (to zawiera czêœæ œrodkowa).
