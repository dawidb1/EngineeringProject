\newcommand\size{0.8}
\renewcommand{\arraystretch}{1.5}

\chapter{Wstêp}

Choroba Gravesa jest najczêstsz¹, idiopatyczn¹ form¹ nadczynnoœci tarczycy. To choroba autoimmunologiczna, powodowana nadaktywnoœci¹ przeciwcia³ przeciwtarczycowych (TRAb). Imituj¹ one dzia³anie hormonu TSH, stymuluj¹c receptory TSH (TSHR). Efektem jest nadprodukcja hormonów tarczycy: trójjodotyroniny (T3) i tyroksyny (T4) \cite{wiki}, co w konsekwencji prowadzi do nadczynnoœci tarczycy. Przyczyna choroby Gravesa do tej pory nie jest znana.

Standardowe leczenie choroby Gravesa obejmuje terapiê lekami przeciwtarczycowymi \textit{(antithyroid drugs - ATD)}. Jednym z nich jest metimazol (MMI), który hamuje dzia³anie enzymu, odpowiadaj¹cego za syntezê hormonów tarczycy. Taka terapia skutkuje obni¿eniem hormonów T3 i T4, jednak czêsto nie zabezpiecza przed reemisj¹ choroby.

\section{Cele pracy}

\subsection*{Cel bezpoœredni:}
\begin{itemize}
\item wparcie lekarzy w leczeniu choroby autoimmunologicznej Gravesa, poprzez opracowanie spersonalizowanego leczenia, prowadz¹cego do zmniejszenia iloœci przyjmowanego przez pacjenta leku lub obni¿enia ryzyka reemisji. 
\end{itemize}

\subsection*{Cele poœrednie:}

\begin{itemize}
\item napisanie aplikacji okienkowej w œrodowisku Matlab, implementuj¹cej model nadczynnoœci tarczycy wywo³anej chorob¹ Gravesa, u³atwiaj¹cej dobór spersonalizowanej terapii;
\item przeprowadzenie szeregu symulacji prowadz¹cych do realizacji celu g³ównego;
\item wyznaczenie optymalnych terapii dla wybranych pacjentów.

\end{itemize}

\section{Uk³ad pracy}

W pierwszej czêœci pracy zosta³o przedstawione wprowadzenie do uk³adu hormonalnego tarczycy. Omówiono kluczowe kwestie dotycz¹ce choroby Gravesa, takie jak: symptomy, czynniki ryzyka, diagnoza oraz leczenie, ze szczególnym uwzglêdnieniem terapii lekami przeciwtarczycowymi.

Nastêpnie omówiono model matematyczny u¿yty do symulacji terapii dla pacjentów cierpi¹cych na nadczynnoœæ tarczycy wywo³an¹ chorob¹ Gravesa. Opisano za³o¿enia modelu, jego parametry oraz funkcje stanu. Przeprowadzono analizê stabilnoœci punktu stacjonarnego uk³adu równañ ró¿niczkowych.

W kolejnej czêœci pracy przedstawiono specyfikacjê wewnêtrzn¹ i zewnêtrzn¹ napisanej aplikacji okienkowej. Wyszczególniono w nim klasy aplikacji, przep³yw danych pomiêdzy modu³ami, omówiono utworzone metody oraz wykorzystane metody wbudowane w program MATLAB.
Przedstawiono instrukcjê obs³ugi programu oraz jego mo¿liwoœci.

W dalszej czêœci pracy przedstawiono wyniki przeprowadzonych symulacji modelu dla wybranych czterech pacjentów. Dla ka¿dego z pacjentów przedstawiono sugerowane przez autora pracy schematy skutecznych terapii oraz symulowano reakcjê organizmu na podanie leku. Omówiono przypadki 4 pacjentów. Przedstawiono sugerowane przez autora pracy terapie dla ka¿dego z nich oraz porównano ich zapotrzebowanie na lek.

Pracê koñcz¹ spostrze¿enia po analizie wykonanych symulacji, które zapisano w postaci wniosków oraz podsumowania.


\chapter{Wprowadzenie teoretyczne}

\section{Funkcjonowanie uk³adu hormonalnego tarczycy}
Dzia³anie gospodarki hormonalnej tarczycy opisywane jest za pomoc¹ pêtli sprzê¿enia zwrotnego \cite{mayo} (Rys.~\ref{feedback-loop_img}). Stê¿enie hormonów tarczycowych jest sterowane przez centralny uk³ad nerwowy.  

\begin{figure}[H]
	\centering
	\includegraphics[width=0.45\textwidth]{visio/feedback-loop}
	\caption{Pêtla sprzê¿enia zwrotnego, poprawnie dzia³aj¹cej gospodarki hormonalnej tarczycy \cite{graves1}.}\label{feedback-loop_img}
\end{figure}

Podwzgórze produkuje tyreoliberynê (TRH), która uwalnia wyprodukowan¹ i zmagazynowan¹ w przysadce mózgowej tyreotropinê (TSH). Jest ona wydzielana do gruczo³ów dokrewnych, w tym do gruczo³u tarczycy, w którym powoduje wytwarzanie hormonów tarczycowych trójjodotyroniny (T3) i tyroksyny (T4). Wysoki poziom T3 i~T4 hamuje wytwarzanie TSH, wykazuj¹c ujemne sprzê¿enie zwrotne.


W chorobie Gravesa, przeciwcia³a przeciwtarczycowe TRAb imituj¹ dzia³anie hormonu TSH, pochodz¹cego z przysadki mózgowej, aktywuj¹c produkcjê hormonów tarczycowych \cite{graves1}. W efekcie powstaje nadprodukcja hormonów tarczycowych T3 i T4, przy jednoczeœnie niskim poziomie TSH. 


\section{Symptomy}
Hormony tarczycowe maj¹ wp³yw na wiele uk³adów w ca³ym organizmie, dlatego objawy i symptomy wywo³ane chorob¹ Gravesa mog¹ mieæ szeroki zakres oraz znacz¹cy wp³yw na funkcjonowanie ca³ego organizmu. Najczêstsze objawy to \cite{mayo}:
\begin{itemize}
\item niepokój i nerwowoœæ,
\item drobne dr¿enie r¹k i palców,
\item zwiêkszona wra¿liwoœæ na ciep³o, potliwoœæ,
\item utrata wagi, pomimo normalnych nawyków ¿ywieniowych,
\item powiêkszenie siê gruczo³ów tarczycowych,
\item zmiany w cyklach miesi¹czkowych,
\item zaburzenia erekcji lub libido,
\item czêste wypró¿nienia,
\item wy³upiaste oczy,
\item zmêczenie,
\item cienka, czerwona skóra na ³ydkach lub wierzcho³kach stóp,
\item szybkie lub nieregularne bicie serca.
\end{itemize}

\section{Czynniki ryzyka}
Choroba Gravesa mo¿e wyst¹piæ u ka¿dego cz³owieka, jednak niektóre czynniki zwiêkszaj¹ prawdopodobieñstwo jej wyst¹pienia \cite{mayo}:
\begin{itemize}
\item uwarunkowania genetycznie, poniewa¿ czêsto jest dziedziczona;
\item p³eæ, czêœciej wystêpuje u kobiet, ni¿ u mê¿czyzn;
\item wiek, pojawia siê najczêœciej przed 40 rokiem ¿ycia;
\item zaburzenia uk³adu immunologicznego, wystêpuje z innymi zaburzeniami uk³adu immunologicznego, takimi jak cukrzyca pierwszego stopnia czy reumatoidalne zapalenie stawów;
\item emocjonalny lub fizyczny stres;
\item ci¹¿a lub niedawny poród;
\item palenie papierosów, które mo¿e wp³ywaæ na uk³ad autoimmunologiczny.

\section{Diagnoza choroby}
Istnieje kilka sposobów diagnozowania nadczynnoœci tarczycy oraz jej specyficznej odmiany, jak¹ jest choroba Gravesa. Najczêœciej stosowane to:
\item \textit{Test fizyczny.} Lekarz sprawdza, czy oczy s¹ podra¿nione i wystaj¹ce, a gruczo³ tarczycowy jest powiêkszony. Choroba Gravesa zwiêksza metabolizm, dlatego lekarz bada puls i ciœnienie krwi.
\item \textit{Badanie krwi.} Badanie maj¹ce na celu ustalenie poziomu TSH w krwi oraz hormonów tarczycowych. Prawid³owy poziom TSH koreluj¹cy z wysokim poziomem T4 w formie wolnej (FT4), mo¿e œwiadczyæ o nadczynnoœci tarczycy. Dodatkowe badanie iloœci przeciwcia³ przeciwtarczycowych TRAb, pozwala zdiagnozowaæ chorobê Gravesa. Wysoki poziom TRAb i FT4 œwiadczy o pod³o¿u autoimmunologicznym choroby, czyli chorobie Gravesa \cite{graves1}. 
\item \textit{Badanie przyswajalnoœci radioaktywnego jodu.} Organizm potrzebuje jodu, do produkcji hormonów tarczycowych. Podanie ma³ej dawki radioaktywnego jodu oraz póŸniejszy pomiar iloœci hormonów tarczycowych, pozwala ustaliæ przyswajalnoœæ jodu przez tarczycê. Dostarcza to informacji czy nadczynnoœæ tarczycy jest wywo³ana chorob¹ Gravesa. 
\item \textit{Badanie USG.} Dziêki ultradŸwiêkom, mo¿emy ustaliæ czy gruczo³ tarczycowy jest powiêkszony. Jest to bezpieczne badanie, które mo¿e byæ stosowane podczas ci¹¿y.
\end{itemize}

\section{Leczenie}
Leczenie choroby Gravesa, ma na celu zahamowanie produkcji hormonów tarczycowych oraz zmniejszenie ich negatywnego wp³ywu na organizm. Stosowane s¹ \cite{mayo}:
\begin{itemize}
\item terapia  radioaktywnym jodem,
\item leki przeciwtarczycowe (na przyk³ad metimazol),
\item leki beta-adrenolityczne (beta-blockery),
\item operacja chirurgiczna, 
\item leczenie objawu choroby Gravesa – oftalmopatii.
\end{itemize}

Jedn¹ z mo¿liwoœci jest terapia lekami przeciwtarczycowymi, takimi jak metimazol (Rys.~\ref{trab-mmi_img}). Zmniejsza on produkcjê hormonów tarczycowych poprzez zahamowanie dzia³ania enzymu peroksydazy tarczycowej (TPO), która bierze udzia³ w syntezie hormonów tarczycowych utleniaj¹c aniony jodu $(I^{-})$. W skutek tej inhibicji stê¿enie hormonów tarczycowych powraca do poziomu osoby zdrowej. 

\begin{figure}[H]
	\centering
	\includegraphics[width=0.6\textwidth]{visio/trab-mmi}
	\caption{Schemat hamowania nadmiernej produkcji hormonów tarczycowych T3 oraz T4, spowodowanej odpowiedzi¹ autoimmunologiczn¹, poprzez podanie leku przeciwtarczycowego \cite{graves1}.}\label{trab-mmi_img}
\end{figure}

Dotychczas stosowane terapie lekami przeciwtarczycowymi, s¹ doœæ ogólne, pozbawione indywidualnego podejœcia. W pracy przedstawiono program do spersonalizowanej symulacji terapii nadczynnoœci tarczycy. Na podstawie danych, pozyskanych z badañ pacjenta, program pozwala zasymulowaæ, czyli przewidzieæ odpowiedŸ jego organizmu. Aplikacja pozwala skuteczniej zaplanowaæ terapiê i przewidzieæ ewentualne reemisje choroby. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Metodologia}\label{Chapter_Metodologia}

Dobór odpowiedniej dawki leku jest mo¿liwy, poprzez symulacjê zachowania siê organizmu pacjenta oraz jego odpowiedzi na terapiê. Celem terapii jest osi¹gniecie stanu, w którym iloœæ hormonu T4 w formie wolnej (oznaczana jako FT4 \cite{ft4}), zmieni siê do wartoœci charakterystycznej dla osoby zdrowej. 

W napisanej przez Autora niniejszej pracy aplikacji okienkowej w œrodowisku MATLAB, zaimplementowano model matematyczny, przedstawiony w pracy Balamurugan Pandiyan i Stephen J. Merrill \cite{graves1}. Wszelkie za³o¿enia i dane, zaczerpniêto z ich pracy.

\section{Za³o¿enia modelu}
Zaimplementowany model matematyczny pozwala obserwowaæ poziom hormonu T3 w formie wolnej, przeciwcia³ TRAb, metimazolu (MMI) we krwi pacjenta oraz zmianê rozmiaru gruczo³u tarczycy w czasie. Poni¿ej zosta³y wyszczególnione za³o¿enia modelu \cite{graves1}.

\begin{enumerate}
\item Przeciwcia³a tarczycowe TRAb imituj¹ dzia³anie TSH i stymuluj¹ komórki tarczycowe do wzrostu, produkcji i wydzielania hormonów tarczycy.
\item Po za¿yciu doustnie leku w postaci metimazolu (MMI), jest on szybko i~kompletnie absorbowany do surowicy krwi. Jego przyswajalnoœæ, jest estymowana i~wynosi œrednio 93\%.
\item Tarczyca przyswaja MMI z krwi, który dezaktywuje funkcjonalny wzrost gruczo³u. 
\item Dawka leku wch³ania siê z krwi po jego spo¿yciu.
\item Rozmiar gruczo³u tarczycy jest ukrytym kompartmentem w modelu.
\item Po doustnym podaniu leku, stê¿enie MMI w surowicy krwi wykazuje tak¹ sam¹ dynamikê, jak stê¿enie wewn¹trz tarczycy.
\end{enumerate}

\section{Funkcje stanu}

%klucze: (warunki pocz¹tkowe, parametry, zmienne stanu??)

Rozwa¿any model jest uk³adem równañ ró¿niczkowych zwyczajnych w którym przyjmujemy nastêpuj¹ce oznaczenia:

\begin{itemize}
\item x(t) - iloœæ metimazolu (mg) na litr surowicy krwi w chwili czasowej t,
\item y(t) - iloœæ hormonu FT4 (pg) na mililitr surowicy krwi w chwili czasowej t,
\item z(t) - rozmiar funkcjonalny gruczo³u tarczycy (ml) lub objêtoœæ aktywnych komórek w chwili czasowej t.
\item w(t) - iloœæ przeciwcia³ TRAb (U) na mililitr surowicy krwii w chwili czasowej t,
\item s(t) - poziom MMI przyjêtego doustnie na litr objêtoœci cia³a w chwili czasowej~t.

\end{itemize}

\section{Model matematyczny}

Model symuluj¹cy leczenie pacjenta po przyjêciu metimazolu (MMI) przyjmuje postaæ uk³adu równañ ró¿niczkowych zwyczajnych (\ref{eq:uklad}). 

\begin{equation} \label{eq:uklad}
\left\lbrace 
\arraycolsep=1.5pt\def\arraystretch{2.2}
\begin{array}{ll}

\dfrac{dx}{dt} = s(t) - \dfrac{(k_{1}z)x}{k_{a} + x} - k_{2}x\\

\dfrac{dy}{dt} = \dfrac{(k_{3}z)w}{k_{d} + w } - k_{4}y\\

\dfrac{dz}{dt} = k_{5} (\dfrac{w}{z} - N) - k_{6}zx\\

\dfrac{dw}{dt} = k_{7} - \dfrac{k_{7}x}{k_{b} + x} - k_{8}w\\
\end{array}
\right.
\end{equation}

Rozwi¹zania modelu przyjmuj¹ wartoœci nieujemne $x(t){\geq}0,\:  y(t){\geq}0, \: z(t)>0,\: w(t){\geq}~0$ dla dowolnej chwili czasowej t, z warunkami pocz¹tkowymi $E_{0} = (x_{0}, y_{0}, z_{0}, w_{0})$. Szczegó³owy opis uk³adu znajduje siê w dalszej czêœci sekcji.

\begin{equation}
\label{eq:dxdt}
\dfrac{dx}{dt} = s(t) - \dfrac{(k_{1}z)x}{k_{a} + x} - k_{2}x\\
\end{equation}

Równanie \ref{eq:dxdt} opisuje tempo zmian iloœci metimazolu w chwili t, które zale¿y od dawki metimazolu $s(t)$ przyjêtej przez pacjenta w chwili t, pomniejszonej o dwa sk³adniki. Pierwszy sk³adnik $\dfrac{(k_{1}z)x}{k_{a} + x}$, zgodnie z równaniem Michaelisa-Mentena charakteryzuje tempo wch³aniania metimazolu (MMI) przez gruczo³ tarczycy, z uwzglêdnieniem jego rozmiaru ($z$), zak³adaj¹c maksymalny wychwyt leku ($k_{1}$). Drugi sk³adnik $k_{2}x$ odzwierciedla wydalanie lub eliminacjê leku, przez mechanizm niespecyficzny.

\begin{equation}
\label{eq:dydt}
\dfrac{dy}{dt} = \dfrac{(k_{3}z)w}{k_{d} + w } - k_{4}y \\
\end{equation}

Równanie  \ref{eq:dydt} opisuje tempo zmian hormonu tyroksyny w formie wolnej (FT4) w~chwili czasowej t. Pierwsze wyra¿enie $\dfrac{(k_{3}z)w}{k_{d} + w}$, opisuje znany z poprzedniego równania (\ref{eq:dxdt}) mechanizm Michaelisa-Mentena, wykorzystany do obliczenia wskaŸnika wydzielania hormonu FT4, który jest pomniejszony o wskaŸnik ($k_{4}y$) eliminacji FT4 z krwi. 

\begin{equation}
\label{eq:dzdt}
\dfrac{dz}{dt} = k_{5} (\dfrac{w}{z} - N) - k_{6}zx \\
\end{equation}

Równanie \ref{eq:dzdt} opisuje zmiany funkcjonalnego rozmiaru gruczo³u tarczycy. Pierwszy sk³adnik $k_{5}(\dfrac{w}{z} - N)$ zawiera wspó³czynnik wzrostu ($N$) i wzglêdny wspó³czynnik wzrostu ($k_{5}$), w obecnoœci przeciwcia³ przeciwtarczycowych ($w$) \cite{trab}. Drugi sk³adnik $k_{6}zx$ hamuje tempo zmian poprzez wspó³czynnik funckjonalnego rozmiaru tarczycy dla komórek nieaktywowanych przez leczenie MMI. 

\begin{equation}
\label{eq:dwdt}
\dfrac{dw}{dt} = k_{7} - \dfrac{k_{7}x}{k_{b} + x} - k_{8}w
\end{equation}

Równanie \ref{eq:dwdt} opisuje tempo zmian stê¿enia przeciwcia³ przeciwtarczycowych. Parametr $k_{7}$ reprezentuje maksymaln¹ produkcjê przeciwcia³ TRAb, spowodowan¹ odpowiedzi¹ autoimmunologiczn¹, zaœ wyra¿enie $\dfrac{k_{7}x}{k_{b} + x}$, uwzglêdnia mechanizm hamowania odpowiedzi immunologicznej, uruchomiony podaniem metimazolu. Ostatnie wyra¿enie $k_{8}w$, odnosi siê do eliminacji przeciwcia³ TRAb spowodowanej leczeniem.
\\

\section{Parametry modelu} \label{sec:params}
Na podstawie literatury \cite{graves1} przyjêto wartoœci parametrów modelu, zebrane w tabeli (Tab. \ref{tab:params}).

\begin{table}[h]
\caption{Parametry wejœciowe uk³adu równañ ró¿niczkowych \cite{graves1}.}
\label{tab:params}
\begin{tabular}{|l|l|l|l|}
\hline
\textbf{Parametr} & \textbf{Opis}                                                                                                    & \textbf{Wartoœæ}              & \textbf{Jednostka}            \\ \hline
$k_{1}$                & \begin{tabular}[c]{@{}l@{}}Wzglêdne maksymalne tempo \\ wykorzystania MMI.\end{tabular}                                  & $8,374\cdot 10^{-3}$ & mg/($ml\cdot l \cdot \text{dzieñ}$)                  \\ \hline
$k_{2}$              & WskaŸnik tempa eliminacji MMI.                                                                                         & 3,3271                        & 1/\text{dzieñ}                         \\ \hline
$k_{a}$                & \begin{tabular}[c]{@{}l@{}}Sta³a Michealisa-Mentena po³owicznego \\ maksymalnego wykorzystania MMI.\end{tabular} & 0,358068                      & mg/l                          \\ \hline
$k_{3}$                & \begin{tabular}[c]{@{}l@{}}Wzglêdne maksymalne tempo \\ sekrecji FT4.                                                                                 \end{tabular} & Indywidualne                         & $pg/((ml)^{2}\cdot\text{dzieñ})$                   \\ \hline
$k_{d}$                & \begin{tabular}[c]{@{}l@{}}Sta³a Michealisa-Mentena\\ po³owicznej maksymalnej  sekrecji FT4.\end{tabular}        & Indywidualne                          & U/ml                          \\ \hline
$k_{4}$                & WskaŸnik tempa eliminacji FT4.                                                                                         & 0,099021                      & 1/\text{dzieñ}                         \\ \hline
$k_{5}$                
& \begin{tabular}[c]{@{}l@{}}
Wzglêdny wspó³czynnik tempa wzrostu \\objêtoœci aktywnych komórek tarczycy.\end{tabular}                      & Indywidualne       & $(ml)^{3}/(U\cdot\text{dzieñ})$ \\ \hline
N                 
& \begin{tabular}[c]{@{}l@{}}
Maksymalny wspó³czynnik tempa \\ wzrostu objêtoœci aktywnych \\ komórek tarczycy.\end{tabular}                             & Indywidualne                         & $U/(ml)^{2}$     \\ \hline
$k_{6}$                
& \begin{tabular}[c]{@{}l@{}}
Sta³y wspó³czynnik tempa dezaktywacji \\ komórek tarczycy.\end{tabular}                           & 0,001                         & $ml/(mg\cdot\text{dzieñ})$                   \\ \hline
$k_{7}$                & \begin{tabular}[c]{@{}l@{}}Maksymalny wspó³czynnik tempa \\ produkcji przeciwcia³ TRAb.\end{tabular}                    & Indywidualne & $U/(ml\cdot\text{dzieñ})$                    \\ \hline
$k_{b}$                & \begin{tabular}[c]{@{}l@{}}Wspó³czynnik hamowania tempa \\ produkcji  przeciwcia³.\end{tabular}                         & Indywidualne                           & mg/l                      \\ \hline
$k_{8}$                & WskaŸnik tempa eliminacji TRAb.                                                                                        & 0,035                         & 1/\text{dzieñ}                         \\ \hline
\end{tabular}
\end{table}

Maksymalna szybkoœæ przyswajania MMI wzrasta wraz ze zwiêkszaniem dawki leku, przy czym powy¿ej 15 mg/dzieñ, wzrost ten mo¿na pomin¹æ, zatem mo¿na przyj¹æ, i¿ maksymalne wch³anianie leku nastêpuje dla dawki 15 mg/dzieñ. Zak³adaj¹c, ¿e standardowa objêtoœæ funkcjonalna gruczo³u tarczycy podczas nadczynnoœci wynosi 30 ml, a standardowa objêtoœæ organizmu  to 59,71 l, estymujemy parametr $k_{1} = \dfrac{15}{30\cdot 59,71} = 8,374 \cdot 10^{-3} mg/(ml\cdot l\cdot \text{\textit{dzieñ}})$.

Zak³adaj¹c, ¿e stê¿enie leku we krwi jest malej¹c¹ funkcj¹ wyk³adnicz¹ wyznaczamy wskaŸnik wydalania MMI ($k_2$) z zale¿noœci $k_{2} = \dfrac{ln(2)}{5h} = 3,43711/\text{\textit{dzieñ}}$.

Metimazol jest metabolizowany w w¹trobie \cite{tapazole-liver}, która maksimum wydajnoœci osi¹ga w trakcie aktywnoœci cz³owieka, kiedy jest najedzony \cite{liver}. Najwiêksze wydalanie metimazolu, wystêpuje oko³o godziny 12 dla maksymalnej przyjêtej dawki 15 mg/dzieñ \cite{graves1}. Ta informacja pozwala okreœliæ wartoœæ parametru $k_{a} = 0.358068\: mg/l$ w drodze symulacji korzystaj¹c z równania dynamicznego Michealisa-Mentena. 

Na podstawie informacji z badañ pacjentów podczas ich pierwszej wizyty, korzystaj¹c z równania \ref{eq:dydt}, mo¿emy obliczyæ wartoœæ parametru $k_3$ z zale¿noœci
$k_{3} = \dfrac{k_{4}y_{0}(k_{d}+w_{0})}{z_{0}w_{0}}$.

Parametr $k_{d}$ zosta³ estymowany w programie Matlab, za pomoc¹ procedury optymalizacyjnej \textbf{fmincon} z doln¹ granic¹ wynosz¹c¹ 0.05 i górn¹ granic¹ 0.1. 

Wspó³czynnik $k_4$ szybkoœci eliminacji FT4 z organizmu mo¿na wyznaczyæ z analogicznej zale¿noœci jak parametr $k_2$. Dla FT4 zale¿noœæ ta przyjmuje postaæ

\noindent \mbox{$k_{4} = \dfrac{ln(2)}{7 dni} = 0.099021 \text{\textit{ l/dzieñ}}$}.

Znaj¹c parametry $k_4, k_d, y_0$, zgodnie z równaniem \ref{eq:dydt}, przyjmuj¹c $\dfrac{dy}{dt}=0$ dla warunków pocz¹tkowych $w_0, z_0$,  otrzymujemy zale¿noœæ okreœlaj¹c¹ wzglêdne maksymalne tempo sekrecji FT4 ze wzoru $k_{3} = \dfrac{k_{4}y_{0}(k_{d}+w_{0})}{z_{0}w_{0}}$, czyli parametr $k_{3}$.

Parametry $k_{5}$ oraz $k_{6}$ zosta³y wyznaczone w drodze symulacji, poprzez dopasowanie symulacji do danych pacjentów z ca³ego okresu leczenia, minimalizuj¹c b³¹d œredniokwadratowy.

Parametr N, zosta³ wyliczony na podstawie danych o stê¿eniu TRAb oraz obliczonego funkcjonalnego rozmiaru tarczycy pacjenta z pierwszej wizyty $N = \dfrac{w_{0}}{z_{0}}$.

Parametr $k_{8}$ jako wskaŸnik eliminacji przeciwcia³ podobnie jak parametry $k_2$ i $k_4$ wyznaczono z zale¿noœci $k_8 = \dfrac{ln(2)}{20dni} = 0.035 \text{\textit{ l/dzieñ}}$ i wykorzystano do estymowania parametru $k_{7}$ ze wzoru 
$k_{7} = k_{8} \cdot w_{0}$.

Wspó³czynnik $k_{b}$ hamowania tempa produkcji przeciwcia³ TRAb, estymujemy za pomoc¹ procedury Matlaba \textbf{fmincon} z doln¹ granic¹ 3 i górn¹ 12.

\section{Warunki pocz¹tkowe modelu}

Warunki pocz¹tkowe modelu $E_{0} = (x_{0}, y_{0}, z_{0}, w_{0})$, zosta³y ustalone zgodnie z literatur¹ \cite{graves1} w sposób nastêpuj¹cy:

Stê¿enie pocz¹tkowe FT4 $(y_{0})$ oraz przeciwcia³ TRAb $(w_{0})$ pochodzi z badañ podczas pierwszej wizyty pacjenta. 

Pocz¹tkowe stê¿enie MMI $(x_{0})$ w stosunku do objêtoœci dystrybucji (hipotetycznej objêtoœci p³ynów ustrojowych), w tym przypadku objêtoœci surowicy krwi równej 3 litry, wyliczono zgodnie ze wzorem \ref{eq:x0} na podstawie przyjêtej dawki leku.

\begin{equation}
\label{eq:x0}
x_{0} = \dfrac{\text{Dawka leku}}{\text{Objêtoœæ dystrybucji}}
\end{equation}


Pocz¹tkowy rozmiar funkcjonalny tarczycy $(z_{0})$ wyznaczono przyjmuj¹c za³o¿enie, ¿e w chwili pocz¹tkowej $t_0$ tempo zmian MMI w surowicy krwi jest zerowe, zatem pierwsze równanie uk³adu \ref{eq:dxdt} przyjmuje postaæ: $0=s(t) - \dfrac{k_1 z_0 \cdot x_0}{k_a + x_0} - k_2 x_0$. Wyliczaj¹c z tej równoœci $z_0$, otrzymujemy:

\begin{equation}
\label{eq:z0}
z_{0} = \dfrac{(s(t) - k_{2}x_{0})(k_{a} + x_{0})}{k_{1}x_{0}}
\end{equation}

\section{Dane do symulacji}\label{sec:dane}



W niniejszej pracy przeprowadzono szereg symulacji modelu leczenia choroby Gravesa na podstawie danych do³¹czonych do artyku³u \cite{graves1}. Pochodz¹ one z badañ 23 pacjentów i zawieraj¹ informacje dotycz¹ce poziomu FT4, TRAb oraz dniu terapii w~którym badanie zosta³o przeprowadzone.

Pe³na pula badañ obejmowa³a ponad 70 chorych, przy czym do analizy wybrano tych pacjentów, których badania by³y kompletne tzn. obejmowa³y pe³ny zestaw danych. U wielu pacjentów wystêpowa³y braki dotycz¹ce badania TRAb, poniewa¿ przy wizycie kontrolnej, pomiar FT4 jest wystarczaj¹cy, do okreœlenia stadium choroby.

W przeprowadzonych symulacjach wykorzystano jedynie dane z pierwszej wizyty pacjenta. Pomiary w trakcie leczenia zosta³y u¿yte do weryfikacji poprawnoœci dzia³ania modelu.

Do analiz na potrzeby tej pracy, wykorzystano dane czterech pacjentów, zachowuj¹c ich oryginalne oznaczenia (pacjent nr 20, 31, 55, 70). Parametry dla wybranych pacjentów zosta³y przedstawione w tabeli (Tab. \ref{tab:pacjenci}).

\begin{table}[H]
\caption{Parametry modelu \ref{eq:uklad} wybranych pacjentów \cite{graves1}.}
\label{tab:pacjenci}
\begin{tabular}{|l|l|l|l|l|}
\hline
\textbf{Parametr} & \textbf{Pacjent nr 20} & \textbf{Pacjent nr 31} & \textbf{Pacjent nr 55} & \textbf{Pacjant nr 70} \\ \hline
$k_{1}$                & $8,374 \cdot 10^{-3}$   & $8,374 \cdot 10^{-3}$   & $8,374 \cdot 10^{-3}$   & $8,374 \cdot 10^{-3}$   \\ \hline
$k_{2}$                & 3,3271                 & 3,3272                 & 3,3273                 & 3,3274                 \\ \hline
$k_{a}$                & 0,358068               & 0,358068               & 0,358068               & 0,358068               \\ \hline
$k_{3}$                & 0,085                  & 0,08975                & 0,08992                & 0,11784                \\ \hline
$k_{d}$                & 0,067                  & 0,07                   & 0,081                  & 0,075                  \\ \hline
$k_{4}$                & 0,099021               & 0,099021               & 0,099021               & 0,099021               \\ \hline
$k_{5}$                & $10^{6}$               & $10^{6}$               & $10^{6}$               & $10^{6}$               \\ \hline
N                 & 0,25                   & 0,058                  & 0,207                  & 0,293                  \\ \hline
$k_{6}$                & 0,001                  & 0,001                  & 0,001                  & 0,001                  \\ \hline
$k_{7}$                & 0,26                   & 0,061                  & 0,22                   & 0,308                  \\ \hline
$k_{b}$                & 4,95                   & 11,8                   & 4,09                   & 3,15                   \\ \hline
$k_{8}$                & 0,035                  & 0,035                  & 0,035                  & 0,035                  \\ \hline
\end{tabular}
\end{table}

\section{Stabilnoœæ uk³adu} \label{cha:twierdzenie}

Dla nieleczonej nadczynnoœci tarczycy, spowodowanej chorob¹ Gravesa zbadano stabilnoœæ punktów stacjonarnych modelu (\ref{eq:uklad}). Analizê przeprowadzono w oparciu o~twierdzenie o~stabilnoœci punktów stacjonarnych uk³adu równañ ró¿niczkowych.

\subsection*{Twierdzenie \cite{twierdzenie} }
Niech funkcje $f_{i}(y_{1}, y_{2}, ..., y_{n})$ maj¹ ci¹g³e pochodne cz¹stkowe pierwszego rzêdu $(\dfrac{\partial f_{i}}{\partial y_{1}})$, gdzie $1\leq i,j\leq n$, w otoczeniu punkt równowagi $P=(a_{1},a_{2}, ..., a_{n})$ uk³adu. Dodatkowo niech 
\[
J(a_{1},a_{2}, ..., a_{n})
=
\begin{bmatrix}
(\dfrac{\partial f_{1}}{\partial y_{1}}) 
& (\dfrac{\partial f_{1}}{\partial y_{2}}) 
& \cdots 
& (\dfrac{\partial f_{1}}{\partial y_{n}}) \\

(\dfrac{\partial f_{2}}{\partial y_{1}}) 
& (\dfrac{\partial f_{2}}{\partial y_{3}}) 
& \cdots 
& (\dfrac{\partial f_{2}}{\partial y_{n}}) \\

\vdots & \vdots & \ddots & \vdots \\

(\dfrac{\partial f_{n}}{\partial y_{1}}) 
& (\dfrac{\partial f_{n}}{\partial y_{2}}) 
& \cdots 
& (\dfrac{\partial f_{n}}{\partial y_{n}}) 
\end{bmatrix},
\]
gdzie pochodne cz¹stkowe obliczane s¹ w punkcie $(a_{1},a_{2}, ..., a_{n})$.

Wówczas:
\begin{enumerate}
\item je¿eli wszystkie wartoœci w³asne macierzy Jacobiego J(P) maj¹ ujemne czêœci rzeczywiste, to punkt $P=(a_{1},a_{2}, ..., a_{n})$ jest asymptotycznie stabilnym punktem równowagi uk³adu
\item je¿eli co najmniej jedna wartoœæ w³asna macierzy J(P) ma dodatni¹ czêœæ rzeczywist¹, to punkt $P=(a_{1},a_{2}, ..., a_{n})$ jest niestabilnym punktem równowagi uk³adu autonomicznego.
\end{enumerate}

\subsection{Analiza stabilnoœci modelu}
Dla osoby zdrowej nie podajemy leku czyli $s(t) = 0$ i uk³ad \ref{eq:uklad} przyjmuje postaæ:

\begin{equation} \label{eq:uklad_stab}
\left\lbrace 
\arraycolsep=1.5pt\def\arraystretch{2.2}
\begin{array}{ll}

\dfrac{dx}{dt} = \dfrac{(k_{1}z)x}{k_{a} + x} - k_{2}x\\

\dfrac{dy}{dt} = \dfrac{(k_{3}z)w}{k_{d} + w } - k_{4}y\\

\dfrac{dz}{dt} = k_{5} (\dfrac{w}{z} - N) - k_{6}zx\\

\dfrac{dw}{dt} = k_{7} - \dfrac{k_{7}x}{k_{b} + x} - k_{8}w\\
\end{array}
\right.
\end{equation}

Chc¹c sprawdziæ zachowanie siê modelu dla osoby zdrowej wyznaczamy punkty stacjonarne uk³adu \ref{eq:uklad_stab}.

\begin{equation} \label{eq:funkcje_wielu_zmiennych}
\left\lbrace 
\arraycolsep=1.5pt\def\arraystretch{2.2}
\begin{array}{ll}

f(x, y, z, w) = \dfrac{(k_{1}z)x}{k_{a} + x} - k_{2}x\\

g(x, y, z, w) = \dfrac{(k_{3}z)w}{k_{d} + w } - k_{4}y\\

h(x, y, z, w) = k_{5} (\dfrac{w}{z} - N) - k_{6}zx\\

m(x, y, z, w) = k_{7} - \dfrac{k_{7}x}{k_{b} + x} - k_{8}w\\
\end{array}
\right.
\end{equation}

\noindent rozwi¹zuj¹c uk³ad równañ: $ f(x, y, z, w) = 0 \wedge g(x, y, z, w) = 0 \wedge h(x, y, z, w) = 0 \wedge m(x, y, z, w) = 0$.

Dla osoby zdrowej otrzymujemy dok³adnie jeden punkt stacjonarny $E_{1} = (x_{1}, y_{1}, z_{1}, w_{1})$, gdzie
%Gdy nie podaje siê metimazolu $s(t)=0$, stan nadczynnoœci tarczycy opisuje siê jako $E_{1} = (x_{1}, y_{1}, z_{1}, w_{1})$, gdzie 

\begin{equation} \label{eq:e1}
\left\lbrace 
\arraycolsep=1.5pt\def\arraystretch{2.2}
\begin{array}{ll}

x_{1} = 0 \\

y_{1} = \dfrac{k_{3}k_{3}^{2}}{k_{4}k_{8}N(k_{8}k{d}+k{7})}  \\

z_{1} = \dfrac{k_{7}}{k_{8}N}\\

w_{1} = \dfrac{k_{7}}{k_{8}}

\end{array}
\right.
\end{equation}

Aby sprawdziæ stabilnoœæ punktu $E1$ wyznaczamy macierz Jacobiego $J(x,y,z,w)$ pochodnych cz¹stkowych funkcji f, g, h, m (\ref{eq:funkcje_wielu_zmiennych}).

\begin{equation}
\label{eq:matrix}
J((x,y,z,w))
=
\begin{bmatrix}
\dfrac{-(k_{1}k_{a}z+k_{2}(x+k_{a})^2)}{(x+k_{a})^{2}} 
& 0 
& \dfrac{-xk_{1}}{(x+k_{a})} 
& 0 \\

0
& -k_{4} 
& \dfrac{wk_{3}}{w+k_{d}}
& \dfrac{zk_{3}k_{d}}{(w+k_{d})^{2}}  \\

-zk_{6} 
& 0
& \dfrac{-wk_{5}}{z^{2}} - xk_{6}
& \dfrac{k_{5}}{z} \\

\dfrac{-k_{7}k_{b}}{(x+k_{b})^{2}}
& 0
& 0
& -k_{8}

\end{bmatrix},
\end{equation}

Dla punktu $E_1$ otrzymujemy $J(E_1)$:

\begin{equation}
\label{eq:matrix_e1}
J(E_1)
=
\begin{bmatrix}
-\dfrac{k_{1}k_{7}}{k_{8}Nk_{a}} - k_{2}
& 0 
& 0
& 0 \\

0
& -k_{4} 
& \dfrac{k_{3}k_{7}}{k_{8}k_{d}+k_{7}}
& \dfrac{k_{3}k_{7}k_{8}k_{d}}{N(k_{8}k_{d}+k_{7})^{2}} \\

-\dfrac{k_{6}k_{7}}{k_{8}N} 
& 0
& \dfrac{k_{5}k_{8}N^{2}}{k_{7}}
& \dfrac{k_{5}k_{8}N}{k_{7}} \\

\dfrac{k_{7}}{k_{b}}
& 0
& 0
& -k_{8}

\end{bmatrix},
\end{equation}

Wartoœci w³asne ($\lambda$) macierzy $J(E_1)$ wyznaczamy na podstawie jej równania charakterystycznego $det(J(E_1) - \lambda I) = 0$. Macierz J(E1) ma cztery wartoœci w³asne (\ref{eq:lambda}) wyra¿one za pomoca parametrów modelu. Wartoœci w³asne przedstawiaj¹ siê nastêpuj¹co:

\begin{equation} \label{eq:lambda}
\left\lbrace 
\arraycolsep=1.5pt\def\arraystretch{2.2}
\begin{array}{ll}

\lambda_{1} = -k_{4} \\

\lambda_{2} = -k_{8}  \\

\lambda_{3} = -\dfrac{k_{1}k_{7}}{k_{8}Nk_{a}} -k_{2} \\

\lambda_{4} = -\dfrac{k_{5}k_{8}N^2}{k_{7}}

\end{array}
\right.
\end{equation}

Wszystkie wartoœci w³asne maj¹ znak ujemny, poniewa¿ parametry je opisuj¹ce s¹ liczbami dodatnimi, a zatem wszystkie wartoœci w³asne macierzy $J(E_1)$ maj¹ ujemne czêœci rzeczywiste. Zgodnie z twierdzeniem o stabilnoœci uk³adu (\ref{sec:twierdzenie}), rozwa¿any punkt stacjonarny $E_1$ jest asymptotycznie stabilny.

%\emph{Przeprowadzenie symulacji wi¹¿e siê z kilkoma etapami. }
%
%\section{Problem 1}
%\emph{Stworzone no¿yczki powinny cechowaæ siê du¿¹ odpornoœci¹ na korozjê cyfrow¹. Mo¿na w~tym celu wykorzstaæ izolacjê od znaków wodnych (Rys.~\ref{f1}) na poziomie warstwy p³ótna.}
%
%\begin{figure}[H]
% \subfloat[Podpis 1\label{f1:c1}]{\includegraphics[width=0.45\textwidth]{logoPS}} \; % <--- to daje odstêp w poziomie; \\ daje now¹ linijkê
% \subfloat[Podpis 2\label{f1:c2}]{\includegraphics[width=0.45\textwidth]{logoRIB}} 
%  \caption{Podpis ca³oœci nawi¹zuj¹cy do podpisu \protect\subref{f1:c1}.\label{f1}} % wykorzystanie subref mo¿e wymagaæ dodania \protect !!!
%\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Czêœæ konstrukcyjna/Specyfikacja wewnêtrzna}
%Czêœæ konstrukcyjna lub implementacyjna, t³umacz¹ca sposób realizacji zadania, omówion¹ w poprzedniej czêœci opracowania. Wyjaœnienie wyborów elementów, sprzêtu lub programów. W przypadku programów obiektowych podzia³ na klasy, pola, metody wraz z uzasadnieniem.
%
%\emph{W trakcie realizacji zadania, w~pierwszym kroku, nale¿y odizolowaæ znaki wodne w~warstwie p³ótna. Wykorzystano w~tym celu dostêpn¹ w~œrodowisku XYZ funkcje Z. Parametry do funkcji okreœlono poprez\ldots}

Projekt zosta³ zrealizowany w programie MATLAB. Jest to œrodowisko do wykonywania obliczeñ naukowych i in¿ynierskich, oraz do tworzenia symulacji komputerowych \cite{matlab}. Do utworzenia graficznego interfejsu, u¿yto stosunkowo nowego narzêdzia programu MATLAB - œrodowiska Appdesigner.

\section{Klasy aplikacji}
\begin{table}[]
\caption{Klasy aplikacji.}
\label{tab:interfejsy}
\begin{tabular}{|p{4cm}|p{10.5cm}|}

\hline
\textbf{Nazwa klasy} & \textbf{Opis}                                                                                                                  \\ \hline
Patient          & Parametry pacjenta oraz wyniki pierwszego badania FT4 i~TRAb.                                     \\ \hline
Dose             & Iloœæ metimazolu i czasu leczenia.                                                                      \\ \hline
InitialValues    & Warunki pocz¹tkowe symulacji.                                                                       \\ \hline
StabilityPoint   & Punkty stacjonarne uk³adu.
\\ \hline
Eigen            & Wartoœci w³asne Jacobianu $J(E_1)$.                                                                            \\ \hline
T                & Wektor z punktami czasowymi symulacji.                                                                                         \\ \hline
X                & Rozwi¹zania równañ ró¿niczkowych.
 \\ \hline
StartData        & Wszystkie pola i struktury potrzebne do startu aplikacji.                                                                      \\ \hline
Simulation       & Wszystkie pola i struktury potrzebne do rozpoczêcia symulacji.                                                                 \\ \hline
SimulationResult & Wszystkie pola i struktury potrzebne do wyœwietlenia wyników symulacji.                                                        \\ \hline
\end{tabular}
\end{table}
Utworzono kilka klas, których opis zawarto w tabeli (Tab. \ref{tab:interfejsy}).



Aplikacja przesy³a dane g³ównie pomiêdzy dwoma widokami:
\begin{enumerate}
\item App - Widok w którym aplikacja jest inicjalizowana. Wczytujemy dane, wybieramy szczegó³y symulacji oraz j¹ rozpoczynamy.
\item SimulationView - Widok w którym obserwujemy symulacjê.
\end{enumerate}

\section{Przep³yw danych w aplikacji}
Do przekazania danych pomiêdzy widokami aplikacji, s³u¿¹ g³ównie trzy klasy. S¹ to:
\begin{enumerate}
\item StartData (Rys.~\ref{start_data_img}),
\item Simulation (Rys.~\ref{i-simulation_img}),
\item SimulationResult (Rys.~\ref{simulation_result_img}).
\end{enumerate}

\begin{figure}[H]
	\centering
	\includegraphics[width=0.7\textwidth]{visio/start_data}
	\caption{Klasa StartData.}\label{start_data_img}
\end{figure}

\begin{figure}[H]
	\centering
	\includegraphics[width=\size\textwidth]{visio/simulation}
	\caption{Klasa Simulation.}\label{i-simulation_img}
\end{figure}

\begin{figure}[H]
	\centering
	\includegraphics[width=\size\textwidth]{visio/simulation_result}
	\caption{Klasa SimulationResult.}\label{simulation_result_img}
\end{figure}

\section{Metody aplikacji}\label{sec:methods}

\subsubsection*{Simulate}
Metoda \textit{Simulate} zajmuje siê wszystkimi obliczeniami zwi¹zanymi z symulacj¹. Przyjmuje obiekt typu Simulation (Rys. \ref{i-simulation_img}) i zwraca SimulationResult (Rys. \ref{simulation_result_img}).
\begin{lstlisting}
function SimulationResult = Simulate(Simulation)
\end{lstlisting}

\subsubsection*{UkladRownan}
Metoda \textit{UkladRownan} przyjmuje chwilê czasow¹ t, warunki pocz¹tkowe modelu, parametry pacjenta oraz dawki leczenia. Metoda ta jest wykorzystywana przez solver \textit{ode45} do symulacji modelu dla chwili czasowej t. Zwraca rozwi¹zania uk³adu równañ ró¿niczkowych (\ref{eq:uklad}).
\begin{lstlisting}
function rownania = UkladRownan(t, InitialValuesVector, PatientVector, DoseVector)
\end{lstlisting}


\subsubsection*{TreatmentDose}
Metoda \textit{TreatmentDose} przyjmuje dawki leku, d³ugoœæ terapii w dniach oraz chwilê czasow¹ t. Metoda ta jest wykorzystywana przez solver \textit{ode45}, do obliczania przyjmowanej dawki MMI czyli wartoœci funkcji s(t).
\begin{lstlisting}
function s = TreatmentDose(DOSES, DAYS, t)
\end{lstlisting}

\subsubsection*{StabilityPoints}
Metoda \textit{StabilityPoints} przyjmuje parametry pacjenta i zwraca stabilny punkt stacjonarny w przestrzeni 4-wymiarowej.
\begin{lstlisting}
function points = StabilityPoints(patient)
\end{lstlisting}


\subsubsection*{JacobainMatrix}
Metoda \textit{JacobainMatrix} przyjmuje parametry pacjenta i warunki pocz¹tkowe. Zwraca macierz Jacobiego dla danego uk³adu.
\begin{lstlisting}
function matrix = JacobainMatrix( patient, initialValues )
\end{lstlisting}

\subsubsection*{ConvertStringToNArray}
Metoda \textit{ConvertStringToNArray} konwertuje napis na tablicê liczb. Jako, ¿e jest to osobna metoda w programie, zosta³a sprawdzona testem jednostkowym.
\begin{lstlisting}
function [arrayOutput] = ConvertStringInputToNArray(textInput)
\end{lstlisting}

\subsubsection*{Test\_convertStringInputToNArray}
Test jednostkowy - implementacja skryptu:
\begin{lstlisting}
input = '10, 12, 20, 30';
expected = [10 12 20 30 0]; % N element array

result = ConvertStringInputToNArray(input, 5);

if isequal(result, expected)
    disp('convertStringInputToNArray correct!'); 
else
    disp('convertStringInputToNArray failed!'); 
end
\end{lstlisting}

\subsubsection*{ParsingErrorDialog}
Niektóre z wprowadzanych danych s¹ napisami, dlatego aplikacja jest zabezpieczona metod¹ \textit{ParsingErrorDialog} przed niepoprawnymi wpisami. U¿ytkownik otrzymuje stosowne powiadomienie o b³êdzie.
\begin{lstlisting}
function ParsingErrorDialog(axis)
\end{lstlisting}

\subsubsection*{ShowSimulation}
Do narysowania przebiegów czasowych rozwi¹zañ modelu \ref{eq:uklad} s³u¿y metoda \textit{ShowSimulation}. Jako parametry przyjmuje ona wykres (UIAxes), dane do wykreœlenia (T,~X) oraz tytu³ wykresu (pLabel).
\begin{lstlisting}
function ShowSimulation( UIAxes, T, X, pLabel )
\end{lstlisting}


\subsubsection*{PrintFigure}
Appdesigner nie obs³uguje zaawansowanej manipulacji wykresami, dlatego do zapisania wykresu nale¿y utworzyæ figurê typu widmo, kopiuj¹c wszystkie informacje z~poprzedniego wykresu. S³u¿y do tego metoda \textit{PrintFigure}.
\begin{lstlisting}
function PrintFigure(plotFigure, name)
\end{lstlisting}

\subsubsection*{PlotPhase}
Do narysowania portretów fazowych symulacji, s³u¿y metoda \textit{PlotPhase}.
\begin{lstlisting}
function PlotPhase(ax, x, y, px, py, xlab, ylab)
\end{lstlisting}

\subsubsection*{FindFT4NormalRange}
\textit{FindFT4NormalRange} jest funkcj¹ dodatkow¹. Nie jest zaimplementowana w graficznym interfejsie aplikacji. Wypisuje w konsoli programu Matlab iloœæ dni, po których pacjent, osi¹ga graniczny poziom FT4, dla osoby zdrowej.
\begin{lstlisting}
function timeUpFT4 = FindFT4NormalRange(T, X)
\end{lstlisting}

\section{Wykorzystane funkcje programu Matlab} \label{sec:functions}
\subsubsection*{Ode45}

Do rozwi¹zywania uk³adu równañ ró¿niczkowych \ref{eq:uklad} u¿yto wbudowanej funkcji Matlaba \textit{ode45}. Pocz¹tkowo u¿yto bazowej wersji funkcji \textit{ode45}:

\begin{lstlisting}
[t,y] = ode45(odefun(t,y,A,B),tspan,y0)
\end{lstlisting}

Parametry funkcji:
\begin{itemize}
\item odefun - funkcja zwracaj¹ca równania ró¿niczkowe w chwili t \ref{sec:methods},
\item tspan - przedzia³ czasowy symulacji,
\item y0 - warunki pocz¹tkowe uk³adu \ref{eq:uklad},
\item A i B - wektory dodatkowych parametrów.
\end{itemize}

Funkcja \textit{ode45} zwraca wektor [t,y] gdzie:
\begin{itemize}
\item t - wektor czasu,
\item y - wektor rozwi¹zañ uk³adu równañ ró¿niczkowych \ref{eq:uklad}.
\end{itemize}

W celu optymalizacji wykorzystywanej przez program pamiêci u¿yto przeci¹¿enia metody \textit{ode45}, która mo¿e przyj¹æ dodatkowe parametry A i B, bez umieszczania ich w macierzy wynikowej y. Za pomoc¹ parametrów A, B przekazywane s¹ dane wybranego pacjenta oraz dawki leku. Dziêki takiemu rozwi¹zaniu, symulacja wykorzystuje czterokrotnie mniej miejsca pamiêci RAM.
\begin{lstlisting}
[t,y] = ode45(@(t,y) odefcn(t,y,A,B), tspan, y0);
\end{lstlisting}

\subsubsection*{Eig}
\begin{lstlisting}
e = eig(A)
\end{lstlisting}
Funkcja \textit{eig} przyjmuje jako parametr macierz kwadratow¹ A, zaœ zwraca wektor kolumnowy z wartoœciami w³asnymi macierzy A.

\subsubsection*{Solve}
\begin{lstlisting}
results = solve(eqns, syms);
\end{lstlisting}
Funkcja \textit{Solve} rozwi¹zuje uk³ad równañ u¿ywaj¹c zmiennych symbolicznych. Przyjmuje dwa parametry:
\begin{itemize}
\item eqns - tablicê równañ,
\item syms - tablicê zmiennych symbolicznych u¿ytych w równaniach.
\end{itemize}
Funkcja zwraca wyniki dla zmiennych symbolicznych.

\subsubsection*{Find}
\begin{lstlisting}
k = find(X,n,direction)
\end{lstlisting}
Funkcja \textit{find} przeszukuje wartoœci tablicy lub listy, zwracaj¹c indeksy, dla których równanie jest prawdziwe. Jako argumenty przyjmuje trzy zmienne:
\begin{itemize}
\item X - równanie zawieraj¹ce tablicê do przeszukania i zmienn¹ do której przyrównuje,
\item n - iloœæ indeksów, które pierwsze zostan¹ przyporz¹dkowane,
\item direction - kierunek przyporz¹dkowania.
\end{itemize}

\subsubsection*{Strsplit}
\begin{lstlisting}
C = strsplit(str,delimiter)
\end{lstlisting}
Funkcja \textit{strsplit} dzieli napis na tablicê napisów w miejscach okreœlonego znaku i zwraca tablicê napisów. Parametry funkcji to:
\begin{itemize}
\item str - napis,
\item delimeter - znak, w którego miejscach napis jest roz³¹czany.
\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Instrukcja obs³ugi/Specyfikacja zewnêtrzna}
W tej czêœci zostanie szczegó³owo omówiony program autora pracy wraz z instrukcj¹ jego obs³ugi.

\section{Okno g³ówne aplikacji}
Rys. \ref{window1_img} przedstawia g³ówne okno aplikacji. S³u¿y ono do konfiguracji symulacji, któr¹ mo¿na podzieliæ na trzy czêœci: wybór pacjenta, wybór parametrów symulacji oraz warunki pocz¹tkowe.

\begin{figure}
	\centering
	\includegraphics[width=1\textwidth]{specs/window1}
	\caption{Okno g³ówne aplikacji.}\label{window1_img}
\end{figure}

\subsection{Wybór pacjenta}
W pierwszej czêœci symulacji (Rys.~\ref{choose-patient_img}), u¿ytkownik wybiera jednego z czterech analizowanych w pracy pacjentów (Rys. \ref{patient-list_img}), dla którego przeprowadzone zostan¹ symulacje. Parametry, charakterystyczne dla tego pacjenta zamieszczone s¹ w tabeli (Rys.~\ref{choose-patient_img}). Nowych pacjentów nale¿y dodaæ z poziomu kodu. W przysz³oœci rozwa¿a siê rozszerzenie aplikacji o wygodny sposób dodawania pacjentów.

\begin{figure}
	\centering
	\includegraphics[width=0.4\textwidth]{specs/choose-patient}
	\caption{Wybór pacjenta.}\label{choose-patient_img}
\end{figure}

\begin{figure}
	\centering
	\includegraphics[width=0.4\textwidth]{specs/patient-list}
	\caption{Lista wyboru pacjenta.}\label{patient-list_img}
\end{figure}

\subsection{Wybór parametrów symulacji}
Ta czêœæ s³u¿y do wyboru parametrów symulacji (Rys. \ref{conf:simulation_img}): czasu, leczenia i dawki metimazolu. W pierszym polu u¿ytkowanik wpisuje czas symulacji wyra¿ony w dniach. U¿ywaj¹c w³¹cznika wybieramy leczenie lub jego brak. W³¹czenie terapii aktywuje pole dawki leku, w którym wybieramy iloœæ metimazolu, jak¹ codziennie przyjmuje pacjent.

Terapie mog¹ byæ bardzo skomplikowane, dlatego istnieje mo¿liwoœæ utworzenia schematu leczenia. Wystarczy wpisaæ we wskazane pola kilka wartoœci po przecinku. Dla u³atwienia wprowadzania dawek, poni¿ej umieszczono trzy dodatkowe przyciski (Rys. \ref{conf:simulation_img}). Pierwsze dwa: \textit{Simple Dose} i \textit{Advanced Dose}, automatycznie wpisuj¹ w pole \textit{Dose} domyœlne, przyk³adowe terapie. Trzeci przycisk \textit{Info} informuje, jak wype³niaæ pola zaawansowanej dawki. Rys. \ref{adv-treatment_img} przedstawia przyk³adowy zaawansowany schemat terapii.

\begin{figure}
	\centering
	\includegraphics[width=0.4\textwidth]{specs/simulation}
	\caption{Konfiguracja symulacji bez leczenia.}\label{conf:simulation_img}
\end{figure}

\begin{figure}
	\centering
	\includegraphics[width=0.4\textwidth]{specs/adv-treatment}
	\caption{Konfiguracja zaawansowanego leczenia.}\label{adv-treatment_img}
\end{figure}

\subsection{Warunki pocz¹tkowe}

Wprowadzenie warunków pocz¹tkowych odbywa siê automatycznie, po wyborze pacjenta (Rys. \ref{initial_img}). Poziom FT4, przeciwcia³ i objêtoœæ funkcjonalna tarczycy ustalaj¹ siê po wyborze pacjenta, zaœ pole MMI ustawia siê po wybraniu dawki. 

\begin{figure}
	\centering
	\includegraphics[width=0.4\textwidth]{specs/initial}
	\caption{Przyk³adowe warunki pocz¹tkowe.}\label{initial_img}
\end{figure}

\subsection{Symulacja}
Naciœniêcie przycisku \textit{Simulate}, rozpoczyna symulacjê. Przebieg symulacji potwierdza okno modalne z paskiem postêpu (Rys. \ref{progressbar_img}).
\begin{figure}
	\centering
	\includegraphics[width=0.6\textwidth]{specs/progressbar}
	\caption{Okno modalne oczekiwania na obliczenia.}\label{progressbar_img}
\end{figure}

\section{Okno wyników symulacji}
Okno wyników symulacji (Rys. \ref{window2_img}) pojawia siê po wykonaniu obliczeñ. Po lewej stronie otrzymujemy przebiegi czasowe rozwi¹zañ modelu, zaœ po prawej wykresy zale¿noœci, które mo¿emy  ustaliæ wybieraj¹c z paska kart odpowiednio odciêt¹ oraz rzêdn¹. Nadrzêdna karta \textit{Details} wyœwietla tak¿e szczegó³owe informacje o konfiguracji bie¿¹cej symulacji.

\begin{figure}
	\centering
	\includegraphics[width=1\textwidth]{specs/window2}
	\caption{Okno wyników symulacji.}\label{window2_img}
\end{figure}

\subsection{Graficzne przedstawienie wyników symulacji}
Przyk³adow¹ symulacjê leczenia pacjenta przedstawia Rys. \ref{w2-simulation_img}. Pole wykresu zawiera obszerny tytu³ z istotnymi informacjami dotycz¹cymi terapii pacjenta. Wykres ka¿dej z funkcji stanu, jest narysowany odmiennym kolorem. Dla u³atwienia rozpoznania stadium choroby, przerywanymi poziomymi liniami zosta³y zaznaczone graniczne wartoœci normy FT4 dla osoby zdrowej. Wykresy funkcji opisane s¹ legend¹.

\begin{figure}
	\centering
	\includegraphics[width=0.8\textwidth]{specs/w2-simulation}
	\caption{Przyk³adowe przebiegi czasowe rozwi¹zañ modelu dla wskazanego w tytule schematu terapii.}\label{w2-simulation_img}
\end{figure}

Nad polem wykresów znajduj¹ siê dwa przyciski \textit{Figure} oraz \textit{Print~\&~Copy}. \textit{Figure} deleguje wykres do zaawansowanego narzêdzia edycji wykresów (Rys. \ref{figure-gui_img}). Przycisk \textit{Print \& Figure} zapisuje wykres w katalogu programu, ze szczegó³ow¹ nazw¹ pliku oraz kopiuje go do schowka (Rys. \ref{img-path_img}).

\begin{figure}
	\centering
	\includegraphics[width=0.8\textwidth]{specs/figure-gui}
	\caption{Narzêdzie edycji wykresów.}\label{figure-gui_img}
\end{figure}

\begin{figure}
	\centering
	\includegraphics[width=0.8\textwidth]{specs/img-path}
	\caption{Zapisane w katalogu pliki wyników symulacji.}\label{img-path_img}
\end{figure}

\subsection{Portrety fazowe oraz szczegó³y symulacji}
Prawa czêœæ okna wyników symulacji zawiera dwie zak³adki: \textit{Phase portrait} oraz \textit{Details}. Domyœlnie wyœwietlana jest zak³adka \textit{Phase portrait} (Rys.~\ref{portrait_img}), zawieraj¹ca rzut portretu fazowego na okreœlon¹ przestrzeñ dwuwymiarow¹. Dla funkcji okreœlonej w przestrzeni czterowymiarowej, takich rzutów portretów na przestrzeñ dwuwymiarow¹ jest 8.

\begin{figure}
	\centering
	\includegraphics[width=0.8\textwidth]{specs/portrait}
	\caption{Przyk³adowy wykres zale¿noœci TS(MMI).}\label{portrait_img}
\end{figure}

Po naciœniêciu zak³adki \textit{Details}, otwiera siê czêœæ informuj¹ca u¿ytkownika o szczegó³ach symulacji oraz o wartoœciach w³asnych Jacobianu w punkcie stacjonarnym (Rys.~\ref{details_img}), obliczonych dla wybranego pacjenta w przypadku braku leczenia.

\begin{figure}
	\centering
	\includegraphics[width=0.5\textwidth]{specs/details}
	\caption{Szczegó³y symulacji oraz wyznaczone wartoœci w³asne Jacobianu w punkcie stacjonarnym dla przypadku braku terapi.}\label{details_img}	
\end{figure}


\chapter{Rezultaty} \label{sec:result}
Napisana przez autora pracy aplikacja okienkowa pos³u¿y³a do wykonania i analizy szeregu symulacji terapii pacjentów cierpiacych na nadczynnoœæ tarczycy Gravesa-Basedowa. Do analizy modelu u¿yto danych czterech pacjentów przedstawione w rozdziale \ref{sec:dane} (\textit{Dane do symulacji}) niniejszej pracy. 

\section{Wstêpne porównanie pacjentów}

Rys.~\ref{pacjenci_FT4_trab_img} przedstawia wstêpne porównanie analizowanych pacjentów, ze wzglêdu na zmierzone, podczas pierwszej wizyty u lekarza, wartoœci hormonu FT4 i przeciwcia³ TRAb.

Na najsilniejsz¹ nadczynnoœæ tarczycy, zgodnie z poziomem hormonu FT4, cierpi pacjent numer 70. Potwierdza to równie¿ najwy¿szy poziom przeciwcia³ TRAb w jego krwi. Poziom FT4 pozosta³ych pacjentów jest zbli¿ony. Pacjent numer 30 ma znacz¹co ni¿sz¹ wartoœæ przeciwcia³ TRAb. Jego organizm mo¿e byæ bardzo czu³y na obecnoœæ tych przeciwcia³ lub nadczynnoœæ jest spowodowana innym czynnikiem.

\begin{figure}
	\centering
	\includegraphics[width=1\textwidth]{excel/pacjenci_FT4_trab}
	\caption{Porównanie poziomów FT4 i TRAb analizowanych pacjentów.}\label{pacjenci_FT4_trab_img}
\end{figure}

\section{Pacjent numer 20}

\begin{figure}
	\centering
	\includegraphics[width=\size\textwidth]{wyniki/p20_no_dose_d10}
	\caption{10-dniowa symulacja stanu pacjenta nr 20 bez leczenia (MMI=0).}\label{p20_no_dose_img}
\end{figure}

Opracowanie terapii rozpoczêto od przeanalizowania stanu pacjenta, bez podania leku. Poziom FT4 tego pacjenta wynosi³ 25,63 pg/ml, co jest znacznie powy¿ej normy (7-18 pg/ml). Dowodzi to faktu, i¿ pacjent ten cierpi na nadczynnoœæ tarczycy. Podczas symulacji trwaj¹cej 10 dni, przebiegi czasowe rowi¹zañ modelu, czyli poziom MMI, FT4, funkcjonalny rozmiar gruczo³u tarczycy oraz TRAb s¹ funkcjami sta³ymi, czyli nie zmieniaj¹ siê w czasie (Rys.~\ref{p20_no_dose_img}). Wraz z czasem d¹¿¹cym do nieskoñczonoœci sytuacja nie ulega zmianie. Wynika to z faktu, ¿e przy braku terapii, model jest asymptotycznie stabilny \ref{cha:twierdzenie}.

\begin{figure}
	\centering
	\includegraphics[width=\size\textwidth]{wyniki/p20_dose30_d1}
	\caption{Symulacja dla pacjenta nr 20, leczonego dawk¹ 30 mg MMI, przez jeden dzieñ.}\label{p20_dose30_d1_img}
\end{figure}

Po jednorazowym podaniu 30 mg MMI (Rys.~\ref{p20_dose30_d1_img}), lek zostaje ca³kowicie wydalony z organizmu w czasie jednego dnia. Ta dawka nie ma znacz¹cego wp³ywu na funkcje tarczycy. 
 
\begin{figure}
	\centering
	\includegraphics[width=\size\textwidth]{wyniki/p20_dose30_d120}
	\caption{Symulacja dla pacjenta nr 20, leczonego dawk¹ 30 mg MMI, przez 120 dni.}\label{p20_dose30_d120_img}
\end{figure}

Po podawaniu 30 mg leku przez 120 dni, stan gospodarki hormonalnej tarczycy pacjenta, znacz¹co siê zmieni³ (Rys.~\ref{p20_dose30_d120_img}). Po oko³o 30 dniach, poziom FT4 osi¹gn¹³ graniczny stan dla osoby zdrowej. Kontynuowanie terapii z t¹ sam¹ dawk¹, skutkuje ci¹g³ym obni¿aniem siê poziomu tego hormonu i po 90 dniach osi¹ga on poziom œwiadcz¹cy o niedoczynnoœci tarczycy.

\begin{figure}
	\centering
	\includegraphics[width=\size\textwidth]{wyniki/p20_dose30_d75_dose0_d45}
	\caption{Symulacja dla pacjenta nr 20 podczas leczenia i po odstawieniu leku.}\label{p20_dose30_d75_dose0_d45_img}
\end{figure}
  
Zgodnie z wynikami przedstawionymi na Rys.~\ref{p20_dose30_d75_dose0_d45_img} przy podawaniu dawki 30 mg MMI przez 75 dni i nastêpnie odstawieniu leku, pacjent powróci³ do stanu nadczynnoœci tarczycy, ktory trwa³ do koñca symulacji tj. 35 dni.  Taki scenariusz terapii, okaza³ siê nieskuteczny co oznacza, ¿e pacjent wymaga dalszego leczenia.

\begin{figure}[H]
	\centering
	\includegraphics[width=\size\textwidth]{wyniki/p20_treatment}
	\caption{Symulacja dla pacjenta nr 20, przyk³adowa terapia MMI z dawk¹ podtrzymuj¹c¹ i wznowienie terapii.}\label{p20_treatment_img}
\end{figure}

Rys. \ref{p20_treatment_img} przedstawia przyk³adow¹ terapiê dedykowan¹ dla pacjenta nr 20. Podczas leczenia dawk¹ 30 mg MMI przez 2 miesi¹ce, stê¿enie FT4 pacjenta osi¹gnê³o górn¹ graniczn¹ wartoœæ po 27 dniach. Po 60 dniach stê¿enie to wynosi³o 12,3 pg/ml, dlatego postanowiono zwiêkszyæ dawkê MMI do 40 mg dziennie. Górna graniczna wartoœæ zosta³a osi¹gniêta po 25 dniach, a stê¿enie FT4 pod koniec tego etapu terapii wynios³o 10,97 pg/ml. Ze wzgledu na tendencjê spadkow¹ poziomu FT4 zmniejszono dawkê do 20 pg/ml (przez 30 dni) i dalej do 10 pg/ml (przez 30 dni). Po 4 miesi¹cach, nale¿y sprawdziæ czy choroba jest w stadium reemisji. Jeœli tak, to nale¿y rozpocz¹æ kolejny etap leczenia, stosuj¹c taki sam schemat dawkowania. W przeciwnym przypadku, nale¿y zaprzestaæ leczenia i umówiæ pacjenta na wizytê kontroln¹.

W artykue A. Prakash'a \cite{mmi}, opisane zosta³y ró¿ne opcje leczenia choroby Gravesa. Niektóre z badañ wskazuj¹, ¿e du¿e dawki metimazolu i krótka terapia zwiêkszaj¹ ryzyko wyst¹pienia nawrotów choroby. Optymalna d³ugoœæ terapii powinna wynosiæ \mbox{12-18} miesiêcy. Przy 18-miesiêcznej terapii, ryzyko nawrotu choroby to 37\%, 6-miesiêczna terapia wywo³a nawrót u 58\% leczonych.

Stosuj¹c siê do zaleceñ zawartych w artykule \cite{mmi}  opracowano terapiê (Rys.~\ref{p20_treatment1_img}) dla pacjenta \mbox{nr 20}. Zaproponowany schemat terapii przewiduje 12 miesiêcy leczenia. Podawane dawki to 30 mg MMI przez 2 miesi¹ce, 20 mg przez 2 miesi¹ce, 15 mg przez 2 miesi¹ce i 5 mg przez 6 miesiêcy. W efekcie zaproponowanej terapii hormon FT4 pacjenta osi¹ga poziom  FT4 cz³owieka zdrowego po 27 dniach leczenia.

\begin{figure}
	\centering
	\includegraphics[width=\size\textwidth]{wyniki/p20_treatment1}
	\caption{Symulacja dla pacjenta nr 20, sugerowana 12-miesiêczna terapia MMI.}\label{p20_treatment1_img}
\end{figure}

\section{Pacjent numer 31}

Pacjent numer 31 jest odmiennym przypadkiem w porównaniu do innych pacjentów, gdy¿ poziom jego przeciwcia³ jest niski przy podobnym stê¿eniu FT4. Symulacje wykaza³y (Rys. ~\ref{p31_treatment_img}), ¿e jest ma³o wra¿liwy na leczenie metimazolem, poniewa¿ po jego podaniu du¿ych dawek MMI, poziom FT4 spada bardzo powoli. Dla tego pacjenta, warto rozpatrywaæ alternatywne metody leczenia. Opracowana terapia obejmuje zwiêkszenie dawki leku (Rys.~\ref{p31_treatment_img}). Podawane s¹ dawki 40 mg MMI przez pierwsze 3 miesi¹ce, nastêpnie 30 mg przez 4 miesi¹ce, 20 mg przez 5 miesiêcy i 10 mg przez ostatnie 6 miesiêcy. Leczenie trwa 18 miesiêcy, przy czym ostatnie 6 miesiêcy, pacjent pobiera dawkê 10 mg MMI jako dawkê podtrzymuj¹c¹. Wed³ug symulacji terapia metimazolem, pozwala regulowaæ gospodarkê hormonaln¹ tego pacjenta, jednak do tego celu potrzeba czasu oraz du¿ej iloœci MMI.

\begin{figure}[H]
	\centering
	\includegraphics[width=\size\textwidth]{wyniki/p31_treatment}
	\caption{Symulacja dla pacjenta nr 31, sugerowana 18-miesiêczna terapia MMI.}\label{p31_treatment_img}
\end{figure}


\section{Pacjent numer 55}

\begin{figure}
	\centering
	\includegraphics[width=\size\textwidth]{wyniki/p55_treatment}
	\caption{Symulacja dla pacjenta nr 55, sugerowana 12-miesiêczna terapia MMI.}\label{p55_treatment_img}
\end{figure}

Rys.~\ref{p55_treatment_img} przedstawia sugerowan¹ terapiê dla pacjenta numer 55. Zastosowano to samo leczenie, co w przypadku pacjenta nr 20 (Rys.~\ref{p20_treatment_img}). Podczas 12 miesiêcy co 2 miesi¹ce dawka MMI jest zmniejszana. Podawane s¹ dawki 30, 20, 15 i 5 mg MMI. Dawka podtrzymuj¹ca leczenie wynosi 5 mg i jest podawana przez ostatnie 6 miesiêcy terapii. Pacjent osi¹ga poziom FT4 odpowiadaj¹cy górnej granicy FT4 dla osoby zdrowej po 29 dniach, co oznacza, ¿e od tego czasu jego uk³ad hormonalny tarczycy dzia³a podobnie do osoby zdrowej.

\section{Pacjent numer 70}

Pacjent nr 70 ma najwy¿szy pocz¹tkowy poziom hormonu FT4. Proponowana terapia trwa 14 miesiêcy (Rys.~\ref{p70_treatment_img}). Przez pierwsze 2 miesi¹ce stosujemy dawkê 30 mg/dziennie, nastêpnie zmniejszamy dawkê do 20 mg MMI (przez 3 miesi¹ce) i 15 mg (przez 3 miesi¹ce). Jako dawkê podtrzymuj¹c¹ terapiê podajemy 5 mg MMI przez 6 miesiêcy. Pacjent osi¹ga poziom FT4 odpowiadaj¹cy górnej granicy FT4 dla osoby zdrowej po 42 dniach. Poniewa¿ poziom FT4 pacjenta koreluje z wysokim poziomem przeciwcia³ TRAb, chory dobrze reaguje na leczenie.

\begin{figure}
	\centering
	\includegraphics[width=\size\textwidth]{wyniki/p70_treatment}
	\caption{Symulacja dla pacjenta nr 70, sugerowana 14-miesiêczna terapia MMI.}\label{p70_treatment_img}
\end{figure}

\section{Porównanie zapotrzebowania na lek}

W niniejszym paragrafie przeanalizowano zapotrzebowanie na lek omawianych w pracy pacjentów. Zsumowano iloœæ przyjêtego leku, podczas sugerowanego leczenia, przez okres pierwszych 360 dni. Dla pacjentów nr 20 oraz 31 jest to koniec terapii. Wyniki zobrazowano na Rys.~\ref{pacjenci_mmi_img}. 3/4 pacjentów przyjmie oko³o 5 g leku przez 12 miesiêcy. Pacjent numer 31 musi przyj¹æ 10 g leku przez 12 miesiêcy oraz bêdzie kontynuowa³ leczenie przez kolejnych 6 miesiêcy.

\begin{figure}
	\centering
	\includegraphics[width=1\textwidth]{excel/pacjenci_mmi}
	\caption{Porównanie zapotrzebowania na lek pacjentów.}\label{pacjenci_mmi_img}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\chapter{Wnioski}
\begin{itemize}

\item Opracowanie spersonalizowanej terapii na podstawie przebiegów czasowych rozwi¹zañ modelu, pozwala na skuteczny dobór  dawek MMI i czasu ich przyjmowania dla osób z nadczynnoœci¹ tarczycy spowodowan¹ chorob¹ Gravesa. Znacz¹co zmniejsza siê ryzyko przedawkowania leku, które mo¿e doprowadziæ do niedoczynnoœci tarczycy lub zwiêkszenia efektów ubocznych przyjmowania metimazolu. Ma to wp³yw na zdrowie i komfort ¿ycia pacjenta.

\item Utworzona aplikacja okienkowa znacz¹co u³atwia wykonanie symulacji. Umo¿liwia zaawansowane sterowanie terapi¹ i ³atwe prze³¹czanie siê pomiêdzy pacjentami. Rozwi¹zania s¹ okreœlone w dziedzinie czasu, co jest intuicyjne i sprzyja analizie. Na ich podstawie mo¿liwy jest dobór optymalnej terapii dla pacjenta.

\item Zastosowanie modelu mo¿e znacz¹co podnieœæ efektywnoœæ terapii, poprzez dobór optymalnej œcie¿ki leczenia oraz dawek. Takie podejœcie pozwala efektywnie zaplanowaæ kolejne wizyty, zmniejszaj¹c tym samym iloœæ badañ. Modelowanie matematyczne pozwala na predykcjê remisji b¹dŸ reemisji choroby.


\item Przedstawiony model nadczynnoœci tarczycy spowodowanej chorob¹ Gravesa pozwala symulowaæ terapie, jednak wyznaczenie wzglêdnego wspó³czynnika tempa wzrostu ($k_5$) oraz sta³ego wspó³czynnika tempa dezaktywacji komórek tarczycy ($k_6$) polega na minimalizacji b³êdu œredniokwadratowego wzglêdem poprzednich terapii pacjenta. Dlatego nie mo¿na stosowaæ symulacji dla pacjentów podczas ich pierwszej wizyty, a iloœæ wczeœniejszych terapii zwiêksza dok³adnoœæ modelu. Jest to istotny problem, który mo¿na próbowaæ rozwi¹zaæ, poprzez terapiê wstêpn¹, która mia³aby na celu przybli¿enie wskazanych parametrów. W tym aspekcie projekt jest rozwojowy i wymaga dalszych badañ.

\item Optymalizacja kodu, poprzez stosowanie w³aœciwych metod, mo¿e znacz¹co zwiêkszyæ wydajnoœæ aplikacji i zmniejszyæ zu¿ycie zasobów. Zastosowanie przeci¹¿enia metody, pozwoli³o zmniejszyæ zapotrzebowanie na pamiêæ RAM czterokrotnie i~znacz¹co skróci³o obliczenia \ref{sec:functions}. Pozwoli³o to na wykonanie wiêkszej liczby symulacji. 
\end{itemize}

\chapter{Podsumowanie}

Wszystkie cele projektu zosta³y zrealizowane. Spersonalizowana symulacja dla pacjenta pozwala prognozowaæ reakcjê jego organizmu i dobraæ optymaln¹ dawkê. W leczeniu choroby Gravesa, dobór w³aœciwych dawek i oscylacja miêdzy prawid³owymi poziomami FT4 mo¿e pozytywnie wp³ywaæ na ca³kowite wyleczenie, jednak hipoteza ta musi zostaæ przebadana w przysz³oœci. 

Narzêdzie nie jest jeszcze na tyle zautomatyzowane, aby mo¿na by³o je wprowadziæ do u¿ytku w gabinecie lekarskim, poniewa¿ nie jest mo¿liwe obliczanie parametrów pacjenta. Istniej¹ jednak przes³anki, by s¹dziæ, ¿e bêdzie to mo¿liwe w niedalekiej przysz³oœci. Jedn¹ z mo¿liwoœci mo¿e byæ zastosowanie terapii pocz¹tkowej, w celu okreœlenia parametrów $k_5$ i $k_6$, czyli w du¿ym przybli¿eniu odpowiedzi pacjenta na lek. Stosowanie tego narzêdzia mo¿e mieæ realny wp³yw na zdrowie i komfort ¿ycia pacjenta.
